{% extends "tenant_folder/base.html" %}
{% load static %}
{% block title %}DÃ©tails du prÃ©-inscrit {% endblock title %}
{% block content %}

<style>
    .completion-check-card {
        transition: all 0.3s ease;
        border: 1px solid #e9ecef;
    }
    
    .completion-check-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        border-color: #dee2e6;
    }
    
    .completion-check-card.completed {
        background-color: rgba(25, 135, 84, 0.1);
        border-color: rgba(25, 135, 84, 0.3);
    }
    
    .completion-check-card.incomplete {
        background-color: rgba(220, 53, 69, 0.1);
        border-color: rgba(220, 53, 69, 0.3);
    }
</style>


<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    

<div class="main-content">
    <div class="page-content">
        <div class="container-fluid">                                                    

            <!-- start page title -->
            <div class="row mb-3">
                <div class="col-12">
                    <div class="d-sm-flex align-items-center justify-content-between bg-white rounded-lg shadow-sm p-3">
                        <div class="d-flex align-items-center">
                            <div class="bg-primary bg-opacity-10 rounded-circle p-2 me-2">
                                <i class="ri-user-line text-primary"></i>
                            </div>
                            <h4 class="mb-0 text-primary">Details du prÃ©-inscrit</h4>
                        </div>
                        <div class="d-flex align-items-center gap-3">
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb m-0 bg-transparent">
                                    <li class="breadcrumb-item">
                                        <a href="javascript: void(0);">CRM</a>
                                    </li>
                                    <li class="breadcrumb-item active">DÃ©tails du prÃ©-inscrit</li>
                                </ol>
                            </nav>
                            <div class="btn-group">
                                <button type="button" class="btn btn-success px-4 py-2" data-bs-toggle="modal" id="validatePreinscritBtn">
                                    <i class="ri-check-line me-2"></i>Valider la prÃ©-inscription
                                </button>
                              
                                <a href="/crm/liste-des-preinscrits/" class="btn btn-light px-4 py-2">
                                    <i class="ri-arrow-left-line me-2"></i>Retour Ã  la liste
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- end page title -->

            <!-- Notification informations supplÃ©mentaires -->
            <div  hidden id="incompleted_infos" class="row mb-4">
                <div class="col-12">
                    <div class="alert alert-warning d-flex align-items-center rounded-4 shadow-sm" role="alert">
                        <div class="bg-warning bg-opacity-10 rounded-circle p-2 me-3">
                            <i class="ri-alert-line text-warning fs-5"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="alert-heading mb-1">Informations supplÃ©mentaires requises</h5>
                            <p class="mb-0">Veuillez complÃ©ter les informations supplÃ©mentaires pour ce prÃ©-inscrit afin de faciliter le processus de validation.</p>
                        </div>
                        <div class="d-flex gap-2">
                            <button type="button" class="btn btn-warning px-4 py-2" id="completeAdditionalInfoBtn">
                                <i class="ri-edit-line me-2"></i>ComplÃ©ter les informations
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notification dossier incomplet -->
            <div hidden id="non_completed_docs" class="row mb-4">
                <div class="col-12">
                    <div class="alert alert-danger d-flex align-items-center rounded-4 shadow-sm" role="alert">
                        <div class="bg-danger bg-opacity-10 rounded-circle p-2 me-3">
                            <i class="ri-error-warning-line text-danger fs-5"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="alert-heading mb-1">Dossier incomplet</h5>
                            <p class="mb-0">Certaines informations obligatoires sont manquantes. Veuillez complÃ©ter le dossier pour continuer.</p>
                        </div>
                        <div class="d-flex gap-2">
                            <button type="button" class="btn btn-danger px-4 py-2" data-bs-toggle="modal" data-bs-target="#missingDocumentsModal">
                                <i class="ri-file-list-line me-2"></i>Voir les documents manquants
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notification dossier complet -->
            <div hidden id="completed_docs" class="row mb-4">
                <div class="col-12">
                    <div class="alert alert-success d-flex align-items-center rounded-4 shadow-sm" role="alert">
                        <div class="bg-success bg-opacity-10 rounded-circle p-2 me-3">
                            <i class="ri-checkbox-circle-line text-success fs-5"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="alert-heading mb-1">Dossier complet</h5>
                            <p class="mb-0">Toutes les informations requises ont Ã©tÃ© fournies. Ce dossier est prÃªt pour la validation.</p>
                        </div>
                        <div class="d-flex gap-2">
                            <span class="badge bg-success px-3 py-2">
                                <i class="ri-check-line me-1"></i>Complet
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notification dÃ©rogation acceptÃ©e -->
            <div hidden id="derogation_acceptee" class="row mb-4">
                <div class="col-12">
                    <div class="alert alert-success d-flex align-items-center rounded-4 shadow-sm" role="alert">
                        <div class="bg-success bg-opacity-10 rounded-circle p-2 me-3">
                            <i class="ri-checkbox-circle-line text-success fs-5"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="alert-heading mb-1">DÃ©rogation acceptÃ©e</h5>
                            <p class="mb-0">La demande de dÃ©rogation a Ã©tÃ© acceptÃ©e. Ce dossier peut Ãªtre validÃ©.</p>
                        </div>
                        <div class="d-flex gap-2">
                            <span class="badge bg-success px-3 py-2">
                                <i class="ri-check-line me-1"></i>AcceptÃ©e
                            </span>
                            <button type="button" class="btn btn-info btn-sm" data-bs-toggle="modal" data-bs-target="#detailsDerogationModal">
                                <i class="ri-eye-line me-1"></i>Voir les dÃ©tails
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notification dÃ©rogation refusÃ©e -->
            <div hidden id="derogation_refusee" class="row mb-4">
                <div class="col-12">
                    <div class="alert alert-danger d-flex align-items-center rounded-4 shadow-sm" role="alert">
                        <div class="bg-danger bg-opacity-10 rounded-circle p-2 me-3">
                            <i class="ri-close-circle-line text-danger fs-5"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="alert-heading mb-1">DÃ©rogation refusÃ©e</h5>
                            <p class="mb-0">La demande de dÃ©rogation a Ã©tÃ© refusÃ©e. Veuillez consulter les dÃ©tails pour plus d'informations.</p>
                        </div>
                        <div class="d-flex gap-2">
                            <span class="badge bg-danger px-3 py-2">
                                <i class="ri-close-line me-1"></i>RefusÃ©e
                            </span>
                            <button type="button" class="btn btn-info btn-sm" data-bs-toggle="modal" data-bs-target="#detailsDerogationModal">
                                <i class="ri-eye-line me-1"></i>Voir les dÃ©tails
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notification dÃ©rogation en attente -->
            <div hidden id="derogation_attente" class="row mb-4">
                <div class="col-12">
                    <div class="alert alert-warning d-flex align-items-center rounded-4 shadow-sm" role="alert">
                        <div class="bg-warning bg-opacity-10 rounded-circle p-2 me-3">
                            <i class="ri-time-line text-warning fs-5"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="alert-heading mb-1">DÃ©rogation en attente</h5>
                            <p class="mb-0">Une demande de dÃ©rogation est en cours de traitement. Veuillez patienter jusqu'Ã  la dÃ©cision finale.</p>
                        </div>
                        <div class="d-flex gap-2">
                            <span class="badge bg-warning px-3 py-2">
                                <i class="ri-time-line me-1"></i>En attente
                            </span>
                            <button type="button" class="btn btn-info btn-sm" data-bs-toggle="modal" data-bs-target="#detailsDerogationModal">
                                <i class="ri-eye-line me-1"></i>Voir les dÃ©tails
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PremiÃ¨re rangÃ©e : Informations personnelles et Fiche de Voeux -->
            <div class="row mb-4">
                <!-- Informations personnelles -->
                <div class="col-lg-4">
                    <div class="card border-0 shadow-sm rounded-4 h-100">
                        <div class="card-header border-0 bg-primary bg-opacity-10 px-4 py-3">
                            <div class="d-flex align-items-center">
                                <div class="modal-icon bg-primary bg-opacity-10 rounded-3 p-3 me-3">
                                    <i class="ri-user-line text-primary fs-4"></i>
                                </div>
                                <div>
                                    <h5 class="card-title fw-semibold text-primary mb-1">Informations personnelles</h5>
                                    <p class="text-muted small mb-0">DÃ©tails du contact</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <div class="mb-4 d-flex align-items-start">
                                <div class="icon-circle bg-primary bg-opacity-10 rounded-circle p-2 me-3">
                                    <i class="ri-user-line text-primary"></i>
                                </div>
                                <div>
                                    <small class="text-muted d-block mb-1">Nom et PrÃ©nom</small>
                                    <span class="fw-semibold" id="nom_prenom">-</span>
                                </div>
                            </div>
                            <div class="mb-4 d-flex align-items-start">
                                <div class="icon-circle bg-secondary bg-opacity-10 rounded-circle p-2 me-3">
                                    <i class="ri-flag-line text-secondary"></i>
                                </div>
                                <div>
                                    <small class="text-muted d-block mb-1">Statut</small>
                                    <span class="fw-semibold" id="statut_preinscrit">-</span>
                                    <p class="text-muted" id="date_changement">-</p>
                                </div>
                            </div>
                            <div class="mb-4 d-flex align-items-start">
                                <div class="icon-circle bg-info bg-opacity-10 rounded-circle p-2 me-3">
                                    <i class="ri-mail-line text-info"></i>
                                </div>
                                <div>
                                    <small class="text-muted d-block mb-1">Email</small>
                                    <span class="fw-semibold" id="email">-</span>
                                </div>
                            </div>
                            <div class="mb-4 d-flex align-items-start">
                                <div class="icon-circle bg-success bg-opacity-10 rounded-circle p-2 me-3">
                                    <i class="ri-phone-line text-success"></i>
                                </div>
                                <div>
                                    <small class="text-muted d-block mb-1">TÃ©lÃ©phone</small>
                                    <span class="fw-semibold" id="phone">-</span>
                                </div>
                            </div>
                            <div class="mb-4 d-flex align-items-start">
                                <div class="icon-circle bg-warning bg-opacity-10 rounded-circle p-2 me-3">
                                    <i class="ri-calendar-line text-warning"></i>
                                </div>
                                <div>
                                    <small class="text-muted d-block mb-1">CrÃ©e le</small>
                                    <span class="fw-semibold" id="created_at">-</span>
                                </div>
                            </div>
                            <div class="d-flex justify-content-center gap-2 mt-3">
                                <button id="viewProfileBtn" type="button" class="btn btn-info btn-sm" >
                                    <i class="ri-eye-line me-1"></i>Voir le profil
                                </button>
                                <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#additionalInfoModal">
                                    <i class="ri-edit-line me-1"></i>Modifier le profil
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section Fiche de Voeux -->
                <div class="col-lg-8">
                    <div class="card border-0 shadow-sm rounded-4 h-100">
                        <div class="card-header border-0 bg-info bg-opacity-10 px-4 py-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center">
                                    <div class="modal-icon bg-info bg-opacity-10 rounded-3 p-3 me-3">
                                        <i class="ri-graduation-cap-line text-info fs-4"></i>
                                    </div>
                                    <div>
                                        <h5 class="card-title fw-semibold text-info mb-1">Fiche de Voeux</h5>
                                        <p class="text-muted small mb-0">Orientation acadÃ©mique du prÃ©-inscrit</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-body p-4 d-flex align-items-center justify-content-center">
                            <div class="row w-100" id="preinscritVoeuxDetails">
                               
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Documents du prÃ©-inscrit -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card border-0 shadow-sm rounded-4">
                        <div class="card-header border-0 bg-warning bg-opacity-10 px-4 py-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center">
                                    <div class="modal-icon bg-warning bg-opacity-10 rounded-3 p-3 me-3">
                                        <i class="ri-folder-line text-warning fs-4"></i>
                                    </div>
                                    <div>
                                        <h5 class="card-title fw-semibold text-warning mb-1">Documents du prÃ©-inscrit</h5>
                                        <p class="text-muted small mb-0">Liste des documents fournis par le prÃ©-inscrit</p>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-warning px-4 py-2" id="addDocumentBtn">
                                    <i class="ri-add-line me-2"></i>Ajouter un document
                                </button>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <div class="table-responsive">
                                <table class="table table-hover align-middle">
                                    <thead class="bg-light">
                                        <tr>
                                            <th class="border-0 rounded-start">Nom du document</th>
                                            <th class="border-0">Type</th>
                                            <th class="border-0">Date d'ajout</th>
                                            <th class="border-0 rounded-end text-end">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="listeDesDocuments">
                                        
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Situation financiÃ¨re -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card border-0 shadow-sm rounded-4">
                        <div class="card-header border-0 bg-success bg-opacity-10 px-4 py-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center">
                                    <div class="modal-icon bg-success bg-opacity-10 rounded-3 p-3 me-3">
                                        <i class="ri-money-euro-circle-line text-success fs-4"></i>
                                    </div>
                                    <div>
                                        <h5 class="card-title fw-semibold text-success mb-1">Situation financiÃ¨re</h5>
                                        <p class="text-muted small mb-0">Ã‰tat des paiements du prÃ©-inscrit</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <div class="d-flex align-items-center bg-light rounded-3 p-3 h-100">
                                        <div class="flex-shrink-0">
                                            <div class="avatar-sm">
                                                <div class="avatar-title bg-success bg-opacity-10 text-success rounded-circle">
                                                    <i class="ri-money-euro-circle-line fs-5"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1">Montant total</h6>
                                            <h4 class="mb-0 fw-bold text-success" id="montant-total">0,00 DZD</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex align-items-center bg-light rounded-3 p-3 h-100">
                                        <div class="flex-shrink-0">
                                            <div class="avatar-sm">
                                                <div class="avatar-title bg-info bg-opacity-10 text-info rounded-circle">
                                                    <i class="ri-bank-line fs-5"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1">Montant payÃ©</h6>
                                            <h4 class="mb-0 fw-bold text-info" id="montant-paye">0,00 DZD</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex align-items-center bg-light rounded-3 p-3 h-100">
                                        <div class="flex-shrink-0">
                                            <div class="avatar-sm">
                                                <div class="avatar-title bg-warning bg-opacity-10 text-warning rounded-circle">
                                                    <i class="ri-alert-line fs-5"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h6 class="mb-1">Solde</h6>
                                            <h4 class="mb-0 fw-bold text-warning" id="solde">0,00 DZD</h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Rappels & Notes -->
            <div class="row">
                <!-- Rappels & Rendez-vous -->
                <div class="col-lg-6">
                    <div class="card border-0 shadow-sm rounded-4 h-100">
                        <div class="card-header border-0 bg-success bg-opacity-10 px-4 py-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center">
                                    <div class="modal-icon bg-success bg-opacity-10 rounded-3 p-3 me-3">
                                        <i class="ri-calendar-check-line text-success fs-4"></i>
                                    </div>
                                    <div>
                                        <h5 class="card-title fw-semibold text-success mb-1">Rappels & Rendez-vous</h5>
                                        <p class="text-muted small mb-0">Gestion des tÃ¢ches et rendez-vous</p>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-success px-4 py-2" id="addReminderBtn">
                                    <i class="ri-add-line me-2"></i>Nouveau rappel
                                </button>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <div class="table-responsive">
                                <table class="table table-hover align-middle">
                                    <thead class="bg-light">
                                        <tr>
                                            <th class="border-0 rounded-start">Type</th>
                                            <th class="border-0">Date & Heure</th>
                                            <th class="border-0">Objet</th>
                                            <th class="border-0">Statut</th>
                                            <th class="border-0 rounded-end text-end">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="listeDesRendezVous">
                                        <!-- Liste des rendez vous -->
                                        
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section Notes -->
                <div class="col-lg-6">
                    <div class="card border-0 shadow-sm rounded-4 h-100">
                        <!-- Header -->
                        <div class="card-header border-0 bg-warning bg-opacity-10 px-4 py-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center">
                                    <div class="modal-icon bg-warning bg-opacity-10 rounded-3 p-3 me-3">
                                        <i class="ri-sticky-note-line text-warning fs-4"></i>
                                    </div>
                                    <div>
                                        <h5 class="card-title fw-semibold text-warning mb-1">Notes</h5>
                                        <p class="text-muted small mb-0">Commentaires et observations</p>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-warning px-4 py-2" id="addNoteModalBtn">
                                    <i class="ri-add-line me-2"></i>Nouvelle note
                                </button>
                            </div>
                        </div>

                        <!-- Body -->
                        <div class="card-body p-4">
                           
                            <!-- Liste des notes -->
                            <div class="vstack gap-4" id="ListeDesNotes">
                                <button type="button" class="border-start border-4 border-dashed border-warning ps-4 py-4 bg-white rounded-end text-start w-100" data-bs-toggle="modal" data-bs-target="#addNoteModal">
                                    <div class="d-flex align-items-center">
                                        <div class="avatar-sm me-3">
                                            <div class="avatar-title bg-warning bg-opacity-10 text-warning rounded-circle fs-5">
                                                <i class="ri-add-line"></i>
                                            </div>
                                        </div>
                                        <div>
                                            <h6 class="fw-medium text-warning mb-0">Ajouter une note</h6>
                                            <small class="text-muted">Cliquez pour ajouter une nouvelle note</small>
                                        </div>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Fin Section Notes-->
             


                    </div>
                </div>
            </div>

        </div>
        <!-- container-fluid -->
    </div>
    <!-- End Page-content -->
</div>

<!-- Modal profil incomplet -->
<div class="modal fade" id="profil_incomplet_modal" tabindex="-1" aria-labelledby="profil_incomplet_modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-warning bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-warning bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-alert-line text-warning fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-warning mb-1" id="profil_incomplet_modalLabel">
                            Profil incomplet
                        </h5>
                        <p class="text-muted small mb-0">Certaines informations sont manquantes</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="text-center mb-4">
                    <div class="avatar-lg mx-auto mb-3">
                        <div class="avatar-title bg-warning bg-opacity-10 text-warning display-5 rounded-circle">
                            <i class="ri-user-unfollow-line"></i>
                        </div>
                    </div>
                    <h5 class="mb-3">Profil incomplet</h5>
                    <p class="text-muted mb-0">
                        Certaines informations importantes du profil n'ont pas Ã©tÃ© complÃ©tÃ©es. Veuillez complÃ©ter les champs manquants pour une meilleure expÃ©rience.
                    </p>
                </div>
                
                <div class="alert alert-info d-flex align-items-center rounded-3 mb-3">
                    <div class="flex-shrink-0 me-2">
                        <i class="ri-information-line fs-4"></i>
                    </div>
                    <div class="flex-grow-1">
                        <p class="mb-0">Les champs obligatoires manquants incluent :</p>
                        <ul class="mb-0 mt-2">
                            <li>Informations d'identitÃ©</li>
                            <li>Informations des parents</li>
                            <li>Informations mÃ©dicales</li>
                            <li>Adresse complÃ¨te</li>
                            <li>Informations acadÃ©miques</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" class="btn btn-warning px-4 py-2" id="completerProfilBtn">
                    <i class="ri-edit-line me-2"></i>ComplÃ©ter le profil
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Informations supplÃ©mentaires -->
<div class="modal fade" id="additionalInfoModal" tabindex="-1" aria-labelledby="additionalInfoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content border-0 shadow-lg">
            <!-- En-tÃªte avec style moderne -->
            <div class="modal-header bg-white border-bottom-0 pt-4 pb-2">
                <div class="d-flex align-items-center">
                    <div class="avatar-sm me-3">
                        <div class="avatar-title bg-primary rounded-circle">
                            <i class="ri-file-info-line text-white fs-5"></i>
                        </div>
                    </div>
                    <div>
                        <h5 class="modal-title fw-bold text-dark" id="additionalInfoModalLabel">
                            Informations supplÃ©mentaires
                        </h5>
                        <p class="text-muted small mb-0">ComplÃ©ter le profil du prÃ©-inscrit</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            
            <!-- Corps de la modale avec onglets -->
            <div class="modal-body p-0">
                <!-- Navigation par onglets -->
                <ul class="nav nav-tabs nav-tabs-custom nav-justified bg-light mx-3 rounded-top" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active fw-medium" data-bs-toggle="tab" href="#identite" role="tab">
                            <i class="ri-user-line me-2"></i>Informations personnelles
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-medium" data-bs-toggle="tab" href="#parents" role="tab">
                            <i class="ri-group-line me-2"></i>Parents
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-medium" data-bs-toggle="tab" href="#medical" role="tab">
                            <i class="ri-heart-line me-2"></i>Informations mÃ©dicales
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-medium" data-bs-toggle="tab" href="#adresse" role="tab">
                            <i class="ri-map-pin-line me-2"></i>Adresse
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-medium" data-bs-toggle="tab" href="#academique" role="tab">
                            <i class="ri-graduation-cap-line me-2"></i>AcadÃ©mique
                        </a>
                    </li>
                </ul>
                
                <!-- Contenu des onglets -->
                <div class="tab-content p-4">
                    <!-- Onglet IdentitÃ© -->
                    <div class="tab-pane active" id="identite" role="tabpanel">
                        <div class="row g-3">
                            <div class="col-12">
                                <h6 class="text-primary fw-semibold mb-3">Informations d'identitÃ©</h6>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Nom en arabe</label>
                                    <input type="text" id="nom_arabe" class="arabic-virtual form-control form-control-sm border rounded-3 py-2" placeholder="Ø§Ù„Ø§Ø³Ù…" dir='rtl'>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">PrÃ©nom en arabe</label>
                                    <input type="text" id="prenom_arabe" class="form-control form-control-sm border rounded-3 py-2" placeholder="Ø§Ù„Ø´Ù‡Ø±Ø©" dir="rtl">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Groupe sanguin</label>
                                    <select id="groupe_sanguin" class="form-select form-select-sm border rounded-3 py-2">
                                        <option value="">SÃ©lectionnez un groupe sanguin</option>
                                        <option value="A+">A+</option>
                                        <option value="A-">A-</option>
                                        <option value="B+">B+</option>
                                        <option value="B-">B-</option>
                                        <option value="AB+">AB+</option>
                                        <option value="AB-">AB-</option>
                                        <option value="O+">O+</option>
                                        <option value="O-">O-</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Date de naissance</label>
                                    <input type="date" id="date_naissance" class="form-control form-control-sm border rounded-3 py-2">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Lieu de naissance</label>
                                    <input type="text" id="lieu_naissance" class="form-control form-control-sm border rounded-3 py-2">
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Nationnalite</label>
                                    <input type="text" id="nationnalite" class="form-control form-control-sm border rounded-3 py-2" placeholder="NationnalitÃ© du preinscrit">
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">NÂ° identification national (NIN)</label>
                                    <input type="text" id="nin" class="form-control form-control-sm border rounded-3 py-2"  maxlength="18" placeholder="NumÃ©ro d'identification national">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">NÂ° sÃ©curite social</label>
                                    <input type="text" id="secu" class="form-control form-control-sm border rounded-3 py-2"  maxlength="18" placeholder="NumÃ©ro sÃ©curite social">
                                </div>
                            </div>

                            
                        </div>
                    </div>
                    
                    <!-- Onglet Parents -->
                    <div class="tab-pane" id="parents" role="tabpanel">
                        <div class="row g-3">
                            <div class="col-12">
                                <h6 class="text-success fw-semibold mb-3">Informations des parents</h6>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">PrÃ©nom pÃ¨re</label>
                                    <input type="text" id="prenom_pere" class="form-control form-control-sm border rounded-3 py-2" placeholder="PrÃ©nom pÃ¨re">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">TÃ©lÃ©phone pÃ¨re</label>
                                    <div class="input-group">
                                        <select id="indicatif_pere" class="form-select form-select-sm border rounded-start-3 py-2">
                                            <option value="0">-----------</option>
                                            <option value="+1">ðŸ‡ºðŸ‡¸ +1 Ã‰tats-Unis / Canada</option>
                                            <option value="+7">ðŸ‡·ðŸ‡º +7 Russie / Kazakhstan</option>
                                            <option value="+20">ðŸ‡ªðŸ‡¬ +20 Ã‰gypte</option>
                                            <option value="+27">ðŸ‡¿ðŸ‡¦ +27 Afrique du Sud</option>
                                            <option value="+30">ðŸ‡¬ðŸ‡· +30 GrÃ¨ce</option>
                                            <option value="+31">ðŸ‡³ðŸ‡± +31 Pays-Bas</option>
                                            <option value="+32">ðŸ‡§ðŸ‡ª +32 Belgique</option>
                                            <option value="+33">ðŸ‡«ðŸ‡· +33 France</option>
                                            <option value="+34">ðŸ‡ªðŸ‡¸ +34 Espagne</option>
                                            <option value="+36">ðŸ‡­ðŸ‡º +36 Hongrie</option>
                                            <option value="+39">ðŸ‡®ðŸ‡¹ +39 Italie</option>
                                            <option value="+40">ðŸ‡·ðŸ‡´ +40 Roumanie</option>
                                            <option value="+41">ðŸ‡¨ðŸ‡­ +41 Suisse</option>
                                            <option value="+43">ðŸ‡¦ðŸ‡¹ +43 Autriche</option>
                                            <option value="+44">ðŸ‡¬ðŸ‡§ +44 Royaume-Uni</option>
                                            <option value="+45">ðŸ‡©ðŸ‡° +45 Danemark</option>
                                            <option value="+46">ðŸ‡¸ðŸ‡ª +46 SuÃ¨de</option>
                                            <option value="+47">ðŸ‡³ðŸ‡´ +47 NorvÃ¨ge</option>
                                            <option value="+48">ðŸ‡µðŸ‡± +48 Pologne</option>
                                            <option value="+49">ðŸ‡©ðŸ‡ª +49 Allemagne</option>
                                            <option value="+51">ðŸ‡µðŸ‡ª +51 PÃ©rou</option>
                                            <option value="+52">ðŸ‡²ðŸ‡½ +52 Mexique</option>
                                            <option value="+53">ðŸ‡¨ðŸ‡º +53 Cuba</option>
                                            <option value="+54">ðŸ‡¦ðŸ‡· +54 Argentine</option>
                                            <option value="+55">ðŸ‡§ðŸ‡· +55 BrÃ©sil</option>
                                            <option value="+56">ðŸ‡¨ðŸ‡± +56 Chili</option>
                                            <option value="+57">ðŸ‡¨ðŸ‡´ +57 Colombie</option>
                                            <option value="+58">ðŸ‡»ðŸ‡ª +58 Venezuela</option>
                                            <option value="+60">ðŸ‡²ðŸ‡¾ +60 Malaisie</option>
                                            <option value="+61">ðŸ‡¦ðŸ‡º +61 Australie</option>
                                            <option value="+62">ðŸ‡®ðŸ‡© +62 IndonÃ©sie</option>
                                            <option value="+63">ðŸ‡µðŸ‡­ +63 Philippines</option>
                                            <option value="+64">ðŸ‡³ðŸ‡¿ +64 Nouvelle-ZÃ©lande</option>
                                            <option value="+65">ðŸ‡¸ðŸ‡¬ +65 Singapour</option>
                                            <option value="+66">ðŸ‡¹ðŸ‡­ +66 ThaÃ¯lande</option>
                                            <option value="+81">ðŸ‡¯ðŸ‡µ +81 Japon</option>
                                            <option value="+82">ðŸ‡°ðŸ‡· +82 CorÃ©e du Sud</option>
                                            <option value="+84">ðŸ‡»ðŸ‡³ +84 Vietnam</option>
                                            <option value="+86">ðŸ‡¨ðŸ‡³ +86 Chine</option>
                                            <option value="+90">ðŸ‡¹ðŸ‡· +90 Turquie</option>
                                            <option value="+91">ðŸ‡®ðŸ‡³ +91 Inde</option>
                                            <option value="+92">ðŸ‡µðŸ‡° +92 Pakistan</option>
                                            <option value="+93">ðŸ‡¦ðŸ‡« +93 Afghanistan</option>
                                            <option value="+94">ðŸ‡±ðŸ‡° +94 Sri Lanka</option>
                                            <option value="+95">ðŸ‡²ðŸ‡² +95 Myanmar</option>
                                            <option value="+98">ðŸ‡®ðŸ‡· +98 Iran</option>
                                            <option value="+211">ðŸ‡¸ðŸ‡¸ +211 Soudan du Sud</option>
                                            <option value="+212">ðŸ‡²ðŸ‡¦ +212 Maroc</option>
                                            <option value="+213">ðŸ‡©ðŸ‡¿ +213 AlgÃ©rie</option>
                                            <option value="+216">ðŸ‡¹ðŸ‡³ +216 Tunisie</option>
                                            <option value="+218">ðŸ‡±ðŸ‡¾ +218 Libye</option>
                                            <option value="+220">ðŸ‡¬ðŸ‡² +220 Gambie</option>
                                            <option value="+221">ðŸ‡¸ðŸ‡³ +221 SÃ©nÃ©gal</option>
                                            <option value="+222">ðŸ‡²ðŸ‡· +222 Mauritanie</option>
                                            <option value="+223">ðŸ‡²ðŸ‡± +223 Mali</option>
                                            <option value="+224">ðŸ‡¬ðŸ‡³ +224 GuinÃ©e</option>
                                            <option value="+225">ðŸ‡¨ðŸ‡® +225 CÃ´te dâ€™Ivoire</option>
                                            <option value="+226">ðŸ‡§ðŸ‡« +226 Burkina Faso</option>
                                            <option value="+227">ðŸ‡³ðŸ‡ª +227 Niger</option>
                                            <option value="+228">ðŸ‡¹ðŸ‡¬ +228 Togo</option>
                                            <option value="+229">ðŸ‡§ðŸ‡¯ +229 BÃ©nin</option>
                                            <option value="+230">ðŸ‡²ðŸ‡º +230 Maurice</option>
                                            <option value="+231">ðŸ‡±ðŸ‡· +231 LibÃ©ria</option>
                                            <option value="+232">ðŸ‡¸ðŸ‡± +232 Sierra Leone</option>
                                            <option value="+233">ðŸ‡¬ðŸ‡­ +233 Ghana</option>
                                            <option value="+234">ðŸ‡³ðŸ‡¬ +234 Nigeria</option>
                                            <option value="+235">ðŸ‡¹ðŸ‡© +235 Tchad</option>
                                            <option value="+236">ðŸ‡¨ðŸ‡² +236 Cameroun</option>
                                            <option value="+237">ðŸ‡¨ðŸ‡« +237 RÃ©publique centrafricaine</option>
                                            <option value="+238">ðŸ‡¨ðŸ‡» +238 Cap-Vert</option>
                                            <option value="+239">ðŸ‡¸ðŸ‡¹ +239 Sao TomÃ© et Principe</option>
                                            <option value="+240">ðŸ‡¬ðŸ‡¶ +240 GuinÃ©e Ã©quatoriale</option>
                                            <option value="+241">ðŸ‡¬ðŸ‡¦ +241 Gabon</option>
                                            <option value="+242">ðŸ‡¨ðŸ‡¬ +242 Congo-Brazzaville</option>
                                            <option value="+243">ðŸ‡¨ðŸ‡© +243 RÃ©publique dÃ©mocratique du Congo</option>
                                            <option value="+244">ðŸ‡¦ðŸ‡´ +244 Angola</option>
                                            <option value="+245">ðŸ‡¬ðŸ‡¼ +245 GuinÃ©e-Bissau</option>
                                            <option value="+246">ðŸ‡®ðŸ‡´ +246 Territoire britannique de lâ€™ocÃ©an Indien</option>
                                            <option value="+248">ðŸ‡¸ðŸ‡¨ +248 Seychelles</option>
                                            <option value="+249">ðŸ‡¸ðŸ‡© +249 Soudan</option>
                                            <option value="+250">ðŸ‡·ðŸ‡¼ +250 Rwanda</option>
                                            <option value="+251">ðŸ‡ªðŸ‡¹ +251 Ã‰thiopie</option>
                                            <option value="+252">ðŸ‡¸ðŸ‡´ +252 Somalie</option>
                                            <option value="+253">ðŸ‡©ðŸ‡¯ +253 Djibouti</option>
                                            <option value="+254">ðŸ‡°ðŸ‡ª +254 Kenya</option>
                                            <option value="+255">ðŸ‡¹ðŸ‡¿ +255 Tanzanie</option>
                                            <option value="+256">ðŸ‡ºðŸ‡¬ +256 Ouganda</option>
                                            <option value="+257">ðŸ‡§ðŸ‡® +257 Burundi</option>
                                            <option value="+258">ðŸ‡²ðŸ‡¿ +258 Mozambique</option>
                                            <option value="+260">ðŸ‡¿ðŸ‡² +260 Zambie</option>
                                            <option value="+261">ðŸ‡²ðŸ‡¬ +261 Madagascar</option>
                                            <option value="+262">ðŸ‡·ðŸ‡ª +262 La RÃ©union</option>
                                            <option value="+263">ðŸ‡¿ðŸ‡¼ +263 Zimbabwe</option>
                                            <option value="+264">ðŸ‡³ðŸ‡¦ +264 Namibie</option>
                                            <option value="+265">ðŸ‡²ðŸ‡¼ +265 Malawi</option>
                                            <option value="+266">ðŸ‡±ðŸ‡¸ +266 Lesotho</option>
                                            <option value="+267">ðŸ‡§ðŸ‡¼ +267 Botswana</option>
                                            <option value="+268">ðŸ‡¸ðŸ‡¿ +268 Eswatini</option>
                                            <option value="+269">ðŸ‡°ðŸ‡² +269 Comores</option>
                                            <option value="+290">ðŸ‡¸ðŸ‡­ +290 Sainte-HÃ©lÃ¨ne</option>
                                            <option value="+291">ðŸ‡ªðŸ‡· +291 Ã‰rythrÃ©e</option>
                                            <option value="+297">ðŸ‡¦ðŸ‡¼ +297 Aruba</option>
                                            <option value="+298">ðŸ‡«ðŸ‡´ +298 ÃŽles FÃ©roÃ©</option>
                                            <option value="+299">ðŸ‡¬ðŸ‡± +299 Groenland</option>
                                            <option value="+350">ðŸ‡¬ðŸ‡® +350 Gibraltar</option>
                                            <option value="+351">ðŸ‡µðŸ‡¹ +351 Portugal</option>
                                            <option value="+352">ðŸ‡±ðŸ‡º +352 Luxembourg</option>
                                            <option value="+353">ðŸ‡®ðŸ‡ª +353 Irlande</option>
                                            <option value="+354">ðŸ‡®ðŸ‡¸ +354 Islande</option>
                                            <option value="+355">ðŸ‡¦ðŸ‡± +355 Albanie</option>
                                            <option value="+356">ðŸ‡²ðŸ‡¹ +356 Malte</option>
                                            <option value="+357">ðŸ‡¨ðŸ‡¾ +357 Chypre</option>
                                            <option value="+358">ðŸ‡«ðŸ‡® +358 Finlande</option>
                                            <option value="+359">ðŸ‡§ðŸ‡¬ +359 Bulgarie</option>
                                            <option value="+370">ðŸ‡±ðŸ‡¹ +370 Lituanie</option>
                                            <option value="+371">ðŸ‡±ðŸ‡» +371 Lettonie</option>
                                            <option value="+372">ðŸ‡ªðŸ‡ª +372 Estonie</option>
                                            <option value="+373">ðŸ‡²ðŸ‡© +373 Moldavie</option>
                                            <option value="+374">ðŸ‡¦ðŸ‡² +374 ArmÃ©nie</option>
                                            <option value="+375">ðŸ‡§ðŸ‡¾ +375 BiÃ©lorussie</option>
                                            <option value="+376">ðŸ‡¦ðŸ‡© +376 Andorre</option>
                                            <option value="+377">ðŸ‡²ðŸ‡¨ +377 Monaco</option>
                                            <option value="+378">ðŸ‡¸ðŸ‡² +378 Saint-Marin</option>
                                            <option value="+380">ðŸ‡ºðŸ‡¦ +380 Ukraine</option>
                                            <option value="+381">ðŸ‡·ðŸ‡¸ +381 Serbie</option>
                                            <option value="+382">ðŸ‡²ðŸ‡ª +382 MontÃ©nÃ©gro</option>
                                            <option value="+385">ðŸ‡­ðŸ‡· +385 Croatie</option>
                                            <option value="+386">ðŸ‡¸ðŸ‡® +386 SlovÃ©nie</option>
                                            <option value="+387">ðŸ‡§ðŸ‡¦ +387 Bosnie-HerzÃ©govine</option>
                                            <option value="+389">ðŸ‡²ðŸ‡° +389 MacÃ©doine du Nord</option>
                                            <option value="+420">ðŸ‡¨ðŸ‡¿ +420 RÃ©publique tchÃ¨que</option>
                                            <option value="+421">ðŸ‡¸ðŸ‡° +421 Slovaquie</option>
                                            <option value="+423">ðŸ‡±ðŸ‡® +423 Liechtenstein</option>
                                            <option value="+500">ðŸ‡«ðŸ‡° +500 ÃŽles Malouines</option>
                                            <option value="+501">ðŸ‡§ðŸ‡¿ +501 Belize</option>
                                            <option value="+502">ðŸ‡¬ðŸ‡¹ +502 Guatemala</option>
                                            <option value="+503">ðŸ‡¸ðŸ‡» +503 Salvador</option>
                                            <option value="+504">ðŸ‡­ðŸ‡³ +504 Honduras</option>
                                            <option value="+505">ðŸ‡³ðŸ‡® +505 Nicaragua</option>
                                            <option value="+506">ðŸ‡¨ðŸ‡· +506 Costa Rica</option>
                                            <option value="+507">ðŸ‡µðŸ‡¦ +507 Panama</option>
                                            <option value="+508">ðŸ‡¸ðŸ‡§ +508 Saint-Pierre-et-Miquelon</option>
                                            <option value="+509">ðŸ‡­ðŸ‡¹ +509 HaÃ¯ti</option>
                                            <option value="+590">ðŸ‡¬ðŸ‡µ +590 Guadeloupe</option>
                                            <option value="+591">ðŸ‡§ðŸ‡´ +591 Bolivie</option>
                                            <option value="+592">ðŸ‡¬ðŸ‡¾ +592 Guyana</option>
                                            <option value="+593">ðŸ‡ªðŸ‡¨ +593 Ã‰quateur</option>
                                            <option value="+594">ðŸ‡¬ðŸ‡« +594 Guyane franÃ§aise</option>
                                            <option value="+595">ðŸ‡µðŸ‡¾ +595 Paraguay</option>
                                            <option value="+596">ðŸ‡²ðŸ‡¶ +596 Martinique</option>
                                            <option value="+597">ðŸ‡¸ðŸ‡· +597 Suriname</option>
                                            <option value="+598">ðŸ‡ºðŸ‡¾ +598 Uruguay</option>
                                            <option value="+599">ðŸ‡¨ðŸ‡¼ +599 CuraÃ§ao</option>
                                        </select>
                                        <input type="text" id="tel_pere" maxlength="12" class="form-control form-control-sm border rounded-end-3 py-2" placeholder="TÃ©lÃ©phone pÃ¨re">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Nom mÃ¨re</label>
                                    <input type="text" id="nom_mere" class="form-control form-control-sm border rounded-3 py-2" placeholder="Nom mÃ¨re">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">PrÃ©nom mÃ¨re</label>
                                    <input type="text" id="prenom_mere" class="form-control form-control-sm border rounded-3 py-2" placeholder="PrÃ©nom mÃ¨re">
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">TÃ©lÃ©phone mÃ¨re</label>
                                    <div class="input-group">
                                        <select id="indicatif_mere" class="form-select form-select-sm border rounded-start-3 py-2">
                                            <option value="0">----------</option>
                                            <option value="+1">ðŸ‡ºðŸ‡¸ +1 Ã‰tats-Unis / Canada</option>
                                            <option value="+7">ðŸ‡·ðŸ‡º +7 Russie / Kazakhstan</option>
                                            <option value="+20">ðŸ‡ªðŸ‡¬ +20 Ã‰gypte</option>
                                            <option value="+27">ðŸ‡¿ðŸ‡¦ +27 Afrique du Sud</option>
                                            <option value="+30">ðŸ‡¬ðŸ‡· +30 GrÃ¨ce</option>
                                            <option value="+31">ðŸ‡³ðŸ‡± +31 Pays-Bas</option>
                                            <option value="+32">ðŸ‡§ðŸ‡ª +32 Belgique</option>
                                            <option value="+33">ðŸ‡«ðŸ‡· +33 France</option>
                                            <option value="+34">ðŸ‡ªðŸ‡¸ +34 Espagne</option>
                                            <option value="+36">ðŸ‡­ðŸ‡º +36 Hongrie</option>
                                            <option value="+39">ðŸ‡®ðŸ‡¹ +39 Italie</option>
                                            <option value="+40">ðŸ‡·ðŸ‡´ +40 Roumanie</option>
                                            <option value="+41">ðŸ‡¨ðŸ‡­ +41 Suisse</option>
                                            <option value="+43">ðŸ‡¦ðŸ‡¹ +43 Autriche</option>
                                            <option value="+44">ðŸ‡¬ðŸ‡§ +44 Royaume-Uni</option>
                                            <option value="+45">ðŸ‡©ðŸ‡° +45 Danemark</option>
                                            <option value="+46">ðŸ‡¸ðŸ‡ª +46 SuÃ¨de</option>
                                            <option value="+47">ðŸ‡³ðŸ‡´ +47 NorvÃ¨ge</option>
                                            <option value="+48">ðŸ‡µðŸ‡± +48 Pologne</option>
                                            <option value="+49">ðŸ‡©ðŸ‡ª +49 Allemagne</option>
                                            <option value="+51">ðŸ‡µðŸ‡ª +51 PÃ©rou</option>
                                            <option value="+52">ðŸ‡²ðŸ‡½ +52 Mexique</option>
                                            <option value="+53">ðŸ‡¨ðŸ‡º +53 Cuba</option>
                                            <option value="+54">ðŸ‡¦ðŸ‡· +54 Argentine</option>
                                            <option value="+55">ðŸ‡§ðŸ‡· +55 BrÃ©sil</option>
                                            <option value="+56">ðŸ‡¨ðŸ‡± +56 Chili</option>
                                            <option value="+57">ðŸ‡¨ðŸ‡´ +57 Colombie</option>
                                            <option value="+58">ðŸ‡»ðŸ‡ª +58 Venezuela</option>
                                            <option value="+60">ðŸ‡²ðŸ‡¾ +60 Malaisie</option>
                                            <option value="+61">ðŸ‡¦ðŸ‡º +61 Australie</option>
                                            <option value="+62">ðŸ‡®ðŸ‡© +62 IndonÃ©sie</option>
                                            <option value="+63">ðŸ‡µðŸ‡­ +63 Philippines</option>
                                            <option value="+64">ðŸ‡³ðŸ‡¿ +64 Nouvelle-ZÃ©lande</option>
                                            <option value="+65">ðŸ‡¸ðŸ‡¬ +65 Singapour</option>
                                            <option value="+66">ðŸ‡¹ðŸ‡­ +66 ThaÃ¯lande</option>
                                            <option value="+81">ðŸ‡¯ðŸ‡µ +81 Japon</option>
                                            <option value="+82">ðŸ‡°ðŸ‡· +82 CorÃ©e du Sud</option>
                                            <option value="+84">ðŸ‡»ðŸ‡³ +84 Vietnam</option>
                                            <option value="+86">ðŸ‡¨ðŸ‡³ +86 Chine</option>
                                            <option value="+90">ðŸ‡¹ðŸ‡· +90 Turquie</option>
                                            <option value="+91">ðŸ‡®ðŸ‡³ +91 Inde</option>
                                            <option value="+92">ðŸ‡µðŸ‡° +92 Pakistan</option>
                                            <option value="+93">ðŸ‡¦ðŸ‡« +93 Afghanistan</option>
                                            <option value="+94">ðŸ‡±ðŸ‡° +94 Sri Lanka</option>
                                            <option value="+95">ðŸ‡²ðŸ‡² +95 Myanmar</option>
                                            <option value="+98">ðŸ‡®ðŸ‡· +98 Iran</option>
                                            <option value="+211">ðŸ‡¸ðŸ‡¸ +211 Soudan du Sud</option>
                                            <option value="+212">ðŸ‡²ðŸ‡¦ +212 Maroc</option>
                                            <option value="+213">ðŸ‡©ðŸ‡¿ +213 AlgÃ©rie</option>
                                            <option value="+216">ðŸ‡¹ðŸ‡³ +216 Tunisie</option>
                                            <option value="+218">ðŸ‡±ðŸ‡¾ +218 Libye</option>
                                            <option value="+220">ðŸ‡¬ðŸ‡² +220 Gambie</option>
                                            <option value="+221">ðŸ‡¸ðŸ‡³ +221 SÃ©nÃ©gal</option>
                                            <option value="+222">ðŸ‡²ðŸ‡· +222 Mauritanie</option>
                                            <option value="+223">ðŸ‡²ðŸ‡± +223 Mali</option>
                                            <option value="+224">ðŸ‡¬ðŸ‡³ +224 GuinÃ©e</option>
                                            <option value="+225">ðŸ‡¨ðŸ‡® +225 CÃ´te dâ€™Ivoire</option>
                                            <option value="+226">ðŸ‡§ðŸ‡« +226 Burkina Faso</option>
                                            <option value="+227">ðŸ‡³ðŸ‡ª +227 Niger</option>
                                            <option value="+228">ðŸ‡¹ðŸ‡¬ +228 Togo</option>
                                            <option value="+229">ðŸ‡§ðŸ‡¯ +229 BÃ©nin</option>
                                            <option value="+230">ðŸ‡²ðŸ‡º +230 Maurice</option>
                                            <option value="+231">ðŸ‡±ðŸ‡· +231 LibÃ©ria</option>
                                            <option value="+232">ðŸ‡¸ðŸ‡± +232 Sierra Leone</option>
                                            <option value="+233">ðŸ‡¬ðŸ‡­ +233 Ghana</option>
                                            <option value="+234">ðŸ‡³ðŸ‡¬ +234 Nigeria</option>
                                            <option value="+235">ðŸ‡¹ðŸ‡© +235 Tchad</option>
                                            <option value="+236">ðŸ‡¨ðŸ‡² +236 Cameroun</option>
                                            <option value="+237">ðŸ‡¨ðŸ‡« +237 RÃ©publique centrafricaine</option>
                                            <option value="+238">ðŸ‡¨ðŸ‡» +238 Cap-Vert</option>
                                            <option value="+239">ðŸ‡¸ðŸ‡¹ +239 Sao TomÃ© et Principe</option>
                                            <option value="+240">ðŸ‡¬ðŸ‡¶ +240 GuinÃ©e Ã©quatoriale</option>
                                            <option value="+241">ðŸ‡¬ðŸ‡¦ +241 Gabon</option>
                                            <option value="+242">ðŸ‡¨ðŸ‡¬ +242 Congo-Brazzaville</option>
                                            <option value="+243">ðŸ‡¨ðŸ‡© +243 RÃ©publique dÃ©mocratique du Congo</option>
                                            <option value="+244">ðŸ‡¦ðŸ‡´ +244 Angola</option>
                                            <option value="+245">ðŸ‡¬ðŸ‡¼ +245 GuinÃ©e-Bissau</option>
                                            <option value="+246">ðŸ‡®ðŸ‡´ +246 Territoire britannique de lâ€™ocÃ©an Indien</option>
                                            <option value="+248">ðŸ‡¸ðŸ‡¨ +248 Seychelles</option>
                                            <option value="+249">ðŸ‡¸ðŸ‡© +249 Soudan</option>
                                            <option value="+250">ðŸ‡·ðŸ‡¼ +250 Rwanda</option>
                                            <option value="+251">ðŸ‡ªðŸ‡¹ +251 Ã‰thiopie</option>
                                            <option value="+252">ðŸ‡¸ðŸ‡´ +252 Somalie</option>
                                            <option value="+253">ðŸ‡©ðŸ‡¯ +253 Djibouti</option>
                                            <option value="+254">ðŸ‡°ðŸ‡ª +254 Kenya</option>
                                            <option value="+255">ðŸ‡¹ðŸ‡¿ +255 Tanzanie</option>
                                            <option value="+256">ðŸ‡ºðŸ‡¬ +256 Ouganda</option>
                                            <option value="+257">ðŸ‡§ðŸ‡® +257 Burundi</option>
                                            <option value="+258">ðŸ‡²ðŸ‡¿ +258 Mozambique</option>
                                            <option value="+260">ðŸ‡¿ðŸ‡² +260 Zambie</option>
                                            <option value="+261">ðŸ‡²ðŸ‡¬ +261 Madagascar</option>
                                            <option value="+262">ðŸ‡·ðŸ‡ª +262 La RÃ©union</option>
                                            <option value="+263">ðŸ‡¿ðŸ‡¼ +263 Zimbabwe</option>
                                            <option value="+264">ðŸ‡³ðŸ‡¦ +264 Namibie</option>
                                            <option value="+265">ðŸ‡²ðŸ‡¼ +265 Malawi</option>
                                            <option value="+266">ðŸ‡±ðŸ‡¸ +266 Lesotho</option>
                                            <option value="+267">ðŸ‡§ðŸ‡¼ +267 Botswana</option>
                                            <option value="+268">ðŸ‡¸ðŸ‡¿ +268 Eswatini</option>
                                            <option value="+269">ðŸ‡°ðŸ‡² +269 Comores</option>
                                            <option value="+290">ðŸ‡¸ðŸ‡­ +290 Sainte-HÃ©lÃ¨ne</option>
                                            <option value="+291">ðŸ‡ªðŸ‡· +291 Ã‰rythrÃ©e</option>
                                            <option value="+297">ðŸ‡¦ðŸ‡¼ +297 Aruba</option>
                                            <option value="+298">ðŸ‡«ðŸ‡´ +298 ÃŽles FÃ©roÃ©</option>
                                            <option value="+299">ðŸ‡¬ðŸ‡± +299 Groenland</option>
                                            <option value="+350">ðŸ‡¬ðŸ‡® +350 Gibraltar</option>
                                            <option value="+351">ðŸ‡µðŸ‡¹ +351 Portugal</option>
                                            <option value="+352">ðŸ‡±ðŸ‡º +352 Luxembourg</option>
                                            <option value="+353">ðŸ‡®ðŸ‡ª +353 Irlande</option>
                                            <option value="+354">ðŸ‡®ðŸ‡¸ +354 Islande</option>
                                            <option value="+355">ðŸ‡¦ðŸ‡± +355 Albanie</option>
                                            <option value="+356">ðŸ‡²ðŸ‡¹ +356 Malte</option>
                                            <option value="+357">ðŸ‡¨ðŸ‡¾ +357 Chypre</option>
                                            <option value="+358">ðŸ‡«ðŸ‡® +358 Finlande</option>
                                            <option value="+359">ðŸ‡§ðŸ‡¬ +359 Bulgarie</option>
                                            <option value="+370">ðŸ‡±ðŸ‡¹ +370 Lituanie</option>
                                            <option value="+371">ðŸ‡±ðŸ‡» +371 Lettonie</option>
                                            <option value="+372">ðŸ‡ªðŸ‡ª +372 Estonie</option>
                                            <option value="+373">ðŸ‡²ðŸ‡© +373 Moldavie</option>
                                            <option value="+374">ðŸ‡¦ðŸ‡² +374 ArmÃ©nie</option>
                                            <option value="+375">ðŸ‡§ðŸ‡¾ +375 BiÃ©lorussie</option>
                                            <option value="+376">ðŸ‡¦ðŸ‡© +376 Andorre</option>
                                            <option value="+377">ðŸ‡²ðŸ‡¨ +377 Monaco</option>
                                            <option value="+378">ðŸ‡¸ðŸ‡² +378 Saint-Marin</option>
                                            <option value="+380">ðŸ‡ºðŸ‡¦ +380 Ukraine</option>
                                            <option value="+381">ðŸ‡·ðŸ‡¸ +381 Serbie</option>
                                            <option value="+382">ðŸ‡²ðŸ‡ª +382 MontÃ©nÃ©gro</option>
                                            <option value="+385">ðŸ‡­ðŸ‡· +385 Croatie</option>
                                            <option value="+386">ðŸ‡¸ðŸ‡® +386 SlovÃ©nie</option>
                                            <option value="+387">ðŸ‡§ðŸ‡¦ +387 Bosnie-HerzÃ©govine</option>
                                            <option value="+389">ðŸ‡²ðŸ‡° +389 MacÃ©doine du Nord</option>
                                            <option value="+420">ðŸ‡¨ðŸ‡¿ +420 RÃ©publique tchÃ¨que</option>
                                            <option value="+421">ðŸ‡¸ðŸ‡° +421 Slovaquie</option>
                                            <option value="+423">ðŸ‡±ðŸ‡® +423 Liechtenstein</option>
                                            <option value="+500">ðŸ‡«ðŸ‡° +500 ÃŽles Malouines</option>
                                            <option value="+501">ðŸ‡§ðŸ‡¿ +501 Belize</option>
                                            <option value="+502">ðŸ‡¬ðŸ‡¹ +502 Guatemala</option>
                                            <option value="+503">ðŸ‡¸ðŸ‡» +503 Salvador</option>
                                            <option value="+504">ðŸ‡­ðŸ‡³ +504 Honduras</option>
                                            <option value="+505">ðŸ‡³ðŸ‡® +505 Nicaragua</option>
                                            <option value="+506">ðŸ‡¨ðŸ‡· +506 Costa Rica</option>
                                            <option value="+507">ðŸ‡µðŸ‡¦ +507 Panama</option>
                                            <option value="+508">ðŸ‡¸ðŸ‡§ +508 Saint-Pierre-et-Miquelon</option>
                                            <option value="+509">ðŸ‡­ðŸ‡¹ +509 HaÃ¯ti</option>
                                            <option value="+590">ðŸ‡¬ðŸ‡µ +590 Guadeloupe</option>
                                            <option value="+591">ðŸ‡§ðŸ‡´ +591 Bolivie</option>
                                            <option value="+592">ðŸ‡¬ðŸ‡¾ +592 Guyana</option>
                                            <option value="+593">ðŸ‡ªðŸ‡¨ +593 Ã‰quateur</option>
                                            <option value="+594">ðŸ‡¬ðŸ‡« +594 Guyane franÃ§aise</option>
                                            <option value="+595">ðŸ‡µðŸ‡¾ +595 Paraguay</option>
                                            <option value="+596">ðŸ‡²ðŸ‡¶ +596 Martinique</option>
                                            <option value="+597">ðŸ‡¸ðŸ‡· +597 Suriname</option>
                                            <option value="+598">ðŸ‡ºðŸ‡¾ +598 Uruguay</option>
                                            <option value="+599">ðŸ‡¨ðŸ‡¼ +599 CuraÃ§ao</option>
                                        </select>
                                        <input type="text" id="tel_mere" class="form-control form-control-sm border rounded-end-3 py-2" placeholder="TÃ©lÃ©phone mÃ¨re">
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <h6 class="text-success fw-semibold mb-3">Informations tuteur lÃ©gal</h6>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                <label class="form-label fw-medium text-muted">Tuteur lÃ©gal</label>
                                <input type="text" id="tuteur_legal" class="form-control form-control-sm border rounded-3 py-2" placeholder="Nom du tuteur lÃ©gal">
                                </div>
                            </div>
                         <div class="col-md-6">
                             <div class="mb-3">
                                <label class="form-label fw-medium text-muted">NumÃ©ro de tÃ©lÃ©phone du tuteur</label>
                                <div class="input-group">
                                        <select id="indicatif_tuteur" class="form-select form-select-sm border rounded-start-3 py-2">
                                            <option value="0">----------</option>
                                            <option value="+1">ðŸ‡ºðŸ‡¸ +1 Ã‰tats-Unis / Canada</option>
                                            <option value="+7">ðŸ‡·ðŸ‡º +7 Russie / Kazakhstan</option>
                                            <option value="+20">ðŸ‡ªðŸ‡¬ +20 Ã‰gypte</option>
                                            <option value="+27">ðŸ‡¿ðŸ‡¦ +27 Afrique du Sud</option>
                                            <option value="+30">ðŸ‡¬ðŸ‡· +30 GrÃ¨ce</option>
                                            <option value="+31">ðŸ‡³ðŸ‡± +31 Pays-Bas</option>
                                            <option value="+32">ðŸ‡§ðŸ‡ª +32 Belgique</option>
                                            <option value="+33">ðŸ‡«ðŸ‡· +33 France</option>
                                            <option value="+34">ðŸ‡ªðŸ‡¸ +34 Espagne</option>
                                            <option value="+36">ðŸ‡­ðŸ‡º +36 Hongrie</option>
                                            <option value="+39">ðŸ‡®ðŸ‡¹ +39 Italie</option>
                                            <option value="+40">ðŸ‡·ðŸ‡´ +40 Roumanie</option>
                                            <option value="+41">ðŸ‡¨ðŸ‡­ +41 Suisse</option>
                                            <option value="+43">ðŸ‡¦ðŸ‡¹ +43 Autriche</option>
                                            <option value="+44">ðŸ‡¬ðŸ‡§ +44 Royaume-Uni</option>
                                            <option value="+45">ðŸ‡©ðŸ‡° +45 Danemark</option>
                                            <option value="+46">ðŸ‡¸ðŸ‡ª +46 SuÃ¨de</option>
                                            <option value="+47">ðŸ‡³ðŸ‡´ +47 NorvÃ¨ge</option>
                                            <option value="+48">ðŸ‡µðŸ‡± +48 Pologne</option>
                                            <option value="+49">ðŸ‡©ðŸ‡ª +49 Allemagne</option>
                                            <option value="+51">ðŸ‡µðŸ‡ª +51 PÃ©rou</option>
                                            <option value="+52">ðŸ‡²ðŸ‡½ +52 Mexique</option>
                                            <option value="+53">ðŸ‡¨ðŸ‡º +53 Cuba</option>
                                            <option value="+54">ðŸ‡¦ðŸ‡· +54 Argentine</option>
                                            <option value="+55">ðŸ‡§ðŸ‡· +55 BrÃ©sil</option>
                                            <option value="+56">ðŸ‡¨ðŸ‡± +56 Chili</option>
                                            <option value="+57">ðŸ‡¨ðŸ‡´ +57 Colombie</option>
                                            <option value="+58">ðŸ‡»ðŸ‡ª +58 Venezuela</option>
                                            <option value="+60">ðŸ‡²ðŸ‡¾ +60 Malaisie</option>
                                            <option value="+61">ðŸ‡¦ðŸ‡º +61 Australie</option>
                                            <option value="+62">ðŸ‡®ðŸ‡© +62 IndonÃ©sie</option>
                                            <option value="+63">ðŸ‡µðŸ‡­ +63 Philippines</option>
                                            <option value="+64">ðŸ‡³ðŸ‡¿ +64 Nouvelle-ZÃ©lande</option>
                                            <option value="+65">ðŸ‡¸ðŸ‡¬ +65 Singapour</option>
                                            <option value="+66">ðŸ‡¹ðŸ‡­ +66 ThaÃ¯lande</option>
                                            <option value="+81">ðŸ‡¯ðŸ‡µ +81 Japon</option>
                                            <option value="+82">ðŸ‡°ðŸ‡· +82 CorÃ©e du Sud</option>
                                            <option value="+84">ðŸ‡»ðŸ‡³ +84 Vietnam</option>
                                            <option value="+86">ðŸ‡¨ðŸ‡³ +86 Chine</option>
                                            <option value="+90">ðŸ‡¹ðŸ‡· +90 Turquie</option>
                                            <option value="+91">ðŸ‡®ðŸ‡³ +91 Inde</option>
                                            <option value="+92">ðŸ‡µðŸ‡° +92 Pakistan</option>
                                            <option value="+93">ðŸ‡¦ðŸ‡« +93 Afghanistan</option>
                                            <option value="+94">ðŸ‡±ðŸ‡° +94 Sri Lanka</option>
                                            <option value="+95">ðŸ‡²ðŸ‡² +95 Myanmar</option>
                                            <option value="+98">ðŸ‡®ðŸ‡· +98 Iran</option>
                                            <option value="+211">ðŸ‡¸ðŸ‡¸ +211 Soudan du Sud</option>
                                            <option value="+212">ðŸ‡²ðŸ‡¦ +212 Maroc</option>
                                            <option value="+213">ðŸ‡©ðŸ‡¿ +213 AlgÃ©rie</option>
                                            <option value="+216">ðŸ‡¹ðŸ‡³ +216 Tunisie</option>
                                            <option value="+218">ðŸ‡±ðŸ‡¾ +218 Libye</option>
                                            <option value="+220">ðŸ‡¬ðŸ‡² +220 Gambie</option>
                                            <option value="+221">ðŸ‡¸ðŸ‡³ +221 SÃ©nÃ©gal</option>
                                            <option value="+222">ðŸ‡²ðŸ‡· +222 Mauritanie</option>
                                            <option value="+223">ðŸ‡²ðŸ‡± +223 Mali</option>
                                            <option value="+224">ðŸ‡¬ðŸ‡³ +224 GuinÃ©e</option>
                                            <option value="+225">ðŸ‡¨ðŸ‡® +225 CÃ´te dâ€™Ivoire</option>
                                            <option value="+226">ðŸ‡§ðŸ‡« +226 Burkina Faso</option>
                                            <option value="+227">ðŸ‡³ðŸ‡ª +227 Niger</option>
                                            <option value="+228">ðŸ‡¹ðŸ‡¬ +228 Togo</option>
                                            <option value="+229">ðŸ‡§ðŸ‡¯ +229 BÃ©nin</option>
                                            <option value="+230">ðŸ‡²ðŸ‡º +230 Maurice</option>
                                            <option value="+231">ðŸ‡±ðŸ‡· +231 LibÃ©ria</option>
                                            <option value="+232">ðŸ‡¸ðŸ‡± +232 Sierra Leone</option>
                                            <option value="+233">ðŸ‡¬ðŸ‡­ +233 Ghana</option>
                                            <option value="+234">ðŸ‡³ðŸ‡¬ +234 Nigeria</option>
                                            <option value="+235">ðŸ‡¹ðŸ‡© +235 Tchad</option>
                                            <option value="+236">ðŸ‡¨ðŸ‡² +236 Cameroun</option>
                                            <option value="+237">ðŸ‡¨ðŸ‡« +237 RÃ©publique centrafricaine</option>
                                            <option value="+238">ðŸ‡¨ðŸ‡» +238 Cap-Vert</option>
                                            <option value="+239">ðŸ‡¸ðŸ‡¹ +239 Sao TomÃ© et Principe</option>
                                            <option value="+240">ðŸ‡¬ðŸ‡¶ +240 GuinÃ©e Ã©quatoriale</option>
                                            <option value="+241">ðŸ‡¬ðŸ‡¦ +241 Gabon</option>
                                            <option value="+242">ðŸ‡¨ðŸ‡¬ +242 Congo-Brazzaville</option>
                                            <option value="+243">ðŸ‡¨ðŸ‡© +243 RÃ©publique dÃ©mocratique du Congo</option>
                                            <option value="+244">ðŸ‡¦ðŸ‡´ +244 Angola</option>
                                            <option value="+245">ðŸ‡¬ðŸ‡¼ +245 GuinÃ©e-Bissau</option>
                                            <option value="+246">ðŸ‡®ðŸ‡´ +246 Territoire britannique de lâ€™ocÃ©an Indien</option>
                                            <option value="+248">ðŸ‡¸ðŸ‡¨ +248 Seychelles</option>
                                            <option value="+249">ðŸ‡¸ðŸ‡© +249 Soudan</option>
                                            <option value="+250">ðŸ‡·ðŸ‡¼ +250 Rwanda</option>
                                            <option value="+251">ðŸ‡ªðŸ‡¹ +251 Ã‰thiopie</option>
                                            <option value="+252">ðŸ‡¸ðŸ‡´ +252 Somalie</option>
                                            <option value="+253">ðŸ‡©ðŸ‡¯ +253 Djibouti</option>
                                            <option value="+254">ðŸ‡°ðŸ‡ª +254 Kenya</option>
                                            <option value="+255">ðŸ‡¹ðŸ‡¿ +255 Tanzanie</option>
                                            <option value="+256">ðŸ‡ºðŸ‡¬ +256 Ouganda</option>
                                            <option value="+257">ðŸ‡§ðŸ‡® +257 Burundi</option>
                                            <option value="+258">ðŸ‡²ðŸ‡¿ +258 Mozambique</option>
                                            <option value="+260">ðŸ‡¿ðŸ‡² +260 Zambie</option>
                                            <option value="+261">ðŸ‡²ðŸ‡¬ +261 Madagascar</option>
                                            <option value="+262">ðŸ‡·ðŸ‡ª +262 La RÃ©union</option>
                                            <option value="+263">ðŸ‡¿ðŸ‡¼ +263 Zimbabwe</option>
                                            <option value="+264">ðŸ‡³ðŸ‡¦ +264 Namibie</option>
                                            <option value="+265">ðŸ‡²ðŸ‡¼ +265 Malawi</option>
                                            <option value="+266">ðŸ‡±ðŸ‡¸ +266 Lesotho</option>
                                            <option value="+267">ðŸ‡§ðŸ‡¼ +267 Botswana</option>
                                            <option value="+268">ðŸ‡¸ðŸ‡¿ +268 Eswatini</option>
                                            <option value="+269">ðŸ‡°ðŸ‡² +269 Comores</option>
                                            <option value="+290">ðŸ‡¸ðŸ‡­ +290 Sainte-HÃ©lÃ¨ne</option>
                                            <option value="+291">ðŸ‡ªðŸ‡· +291 Ã‰rythrÃ©e</option>
                                            <option value="+297">ðŸ‡¦ðŸ‡¼ +297 Aruba</option>
                                            <option value="+298">ðŸ‡«ðŸ‡´ +298 ÃŽles FÃ©roÃ©</option>
                                            <option value="+299">ðŸ‡¬ðŸ‡± +299 Groenland</option>
                                            <option value="+350">ðŸ‡¬ðŸ‡® +350 Gibraltar</option>
                                            <option value="+351">ðŸ‡µðŸ‡¹ +351 Portugal</option>
                                            <option value="+352">ðŸ‡±ðŸ‡º +352 Luxembourg</option>
                                            <option value="+353">ðŸ‡®ðŸ‡ª +353 Irlande</option>
                                            <option value="+354">ðŸ‡®ðŸ‡¸ +354 Islande</option>
                                            <option value="+355">ðŸ‡¦ðŸ‡± +355 Albanie</option>
                                            <option value="+356">ðŸ‡²ðŸ‡¹ +356 Malte</option>
                                            <option value="+357">ðŸ‡¨ðŸ‡¾ +357 Chypre</option>
                                            <option value="+358">ðŸ‡«ðŸ‡® +358 Finlande</option>
                                            <option value="+359">ðŸ‡§ðŸ‡¬ +359 Bulgarie</option>
                                            <option value="+370">ðŸ‡±ðŸ‡¹ +370 Lituanie</option>
                                            <option value="+371">ðŸ‡±ðŸ‡» +371 Lettonie</option>
                                            <option value="+372">ðŸ‡ªðŸ‡ª +372 Estonie</option>
                                            <option value="+373">ðŸ‡²ðŸ‡© +373 Moldavie</option>
                                            <option value="+374">ðŸ‡¦ðŸ‡² +374 ArmÃ©nie</option>
                                            <option value="+375">ðŸ‡§ðŸ‡¾ +375 BiÃ©lorussie</option>
                                            <option value="+376">ðŸ‡¦ðŸ‡© +376 Andorre</option>
                                            <option value="+377">ðŸ‡²ðŸ‡¨ +377 Monaco</option>
                                            <option value="+378">ðŸ‡¸ðŸ‡² +378 Saint-Marin</option>
                                            <option value="+380">ðŸ‡ºðŸ‡¦ +380 Ukraine</option>
                                            <option value="+381">ðŸ‡·ðŸ‡¸ +381 Serbie</option>
                                            <option value="+382">ðŸ‡²ðŸ‡ª +382 MontÃ©nÃ©gro</option>
                                            <option value="+385">ðŸ‡­ðŸ‡· +385 Croatie</option>
                                            <option value="+386">ðŸ‡¸ðŸ‡® +386 SlovÃ©nie</option>
                                            <option value="+387">ðŸ‡§ðŸ‡¦ +387 Bosnie-HerzÃ©govine</option>
                                            <option value="+389">ðŸ‡²ðŸ‡° +389 MacÃ©doine du Nord</option>
                                            <option value="+420">ðŸ‡¨ðŸ‡¿ +420 RÃ©publique tchÃ¨que</option>
                                            <option value="+421">ðŸ‡¸ðŸ‡° +421 Slovaquie</option>
                                            <option value="+423">ðŸ‡±ðŸ‡® +423 Liechtenstein</option>
                                            <option value="+500">ðŸ‡«ðŸ‡° +500 ÃŽles Malouines</option>
                                            <option value="+501">ðŸ‡§ðŸ‡¿ +501 Belize</option>
                                            <option value="+502">ðŸ‡¬ðŸ‡¹ +502 Guatemala</option>
                                            <option value="+503">ðŸ‡¸ðŸ‡» +503 Salvador</option>
                                            <option value="+504">ðŸ‡­ðŸ‡³ +504 Honduras</option>
                                            <option value="+505">ðŸ‡³ðŸ‡® +505 Nicaragua</option>
                                            <option value="+506">ðŸ‡¨ðŸ‡· +506 Costa Rica</option>
                                            <option value="+507">ðŸ‡µðŸ‡¦ +507 Panama</option>
                                            <option value="+508">ðŸ‡¸ðŸ‡§ +508 Saint-Pierre-et-Miquelon</option>
                                            <option value="+509">ðŸ‡­ðŸ‡¹ +509 HaÃ¯ti</option>
                                            <option value="+590">ðŸ‡¬ðŸ‡µ +590 Guadeloupe</option>
                                            <option value="+591">ðŸ‡§ðŸ‡´ +591 Bolivie</option>
                                            <option value="+592">ðŸ‡¬ðŸ‡¾ +592 Guyana</option>
                                            <option value="+593">ðŸ‡ªðŸ‡¨ +593 Ã‰quateur</option>
                                            <option value="+594">ðŸ‡¬ðŸ‡« +594 Guyane franÃ§aise</option>
                                            <option value="+595">ðŸ‡µðŸ‡¾ +595 Paraguay</option>
                                            <option value="+596">ðŸ‡²ðŸ‡¶ +596 Martinique</option>
                                            <option value="+597">ðŸ‡¸ðŸ‡· +597 Suriname</option>
                                            <option value="+598">ðŸ‡ºðŸ‡¾ +598 Uruguay</option>
                                            <option value="+599">ðŸ‡¨ðŸ‡¼ +599 CuraÃ§ao</option>
                                        </select>
                                        <input type="text" id="tel_tuteur" class="form-control form-control-sm border rounded-end-3 py-2" placeholder="TÃ©lÃ©phone tuteur">
                                    </div>
                                </div>
                       </div>
                        </div>
                    </div>
                    
                    <!-- Onglet MÃ©dical -->
                    <div class="tab-pane" id="medical" role="tabpanel">
                        <div class="row g-3">
                            <div class="col-12">
                                <h6 class="text-warning fw-semibold mb-3">Informations mÃ©dicales</h6>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Personne avec besoin spÃ©cifique :</label>
                                    <select id="has_handicap" class="form-select form-select-sm border rounded-3 py-2">
                                        <option value="">SÃ©lectionnez une option</option>
                                        <option value="True">Oui</option>
                                        <option value="False">Non</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Type besoin :</label>
                                    <input type="text" id="type_handicap" class="form-control form-control-sm border rounded-3 py-2" placeholder="DÃ©crivez la nature du besoin">
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <!-- Onglet Adresse -->
                    <div class="tab-pane" id="adresse" role="tabpanel">
                        <div class="row g-3">
                            <div class="col-12">
                                <h6 class="text-info fw-semibold mb-3">Informations de contact</h6>
                            </div>
                            <div class="col-12">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Adresse</label>
                                    <input type="text" id="adresse_prospect" class="form-control form-control-sm border rounded-3 py-2" placeholder="Adresse complÃ¨te" >
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Commune</label>
                                    <input type="text" id="commune" class="form-control form-control-sm border rounded-3 py-2" placeholder="Ville / Commune" >
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Pays</label>
                                    <input type="text" id="pays" class="form-control form-control-sm border rounded-3 py-2" placeholder="Pays de residance" >
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Wilaya</label>
                                    <input type="text" id="wilaya" class="form-control form-control-sm border rounded-3 py-2" placeholder="Wilaya" >
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Code postal</label>
                                    <input type="text" id="code_zip" class="form-control form-control-sm border rounded-3 py-2" placeholder="Code postal" >
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Onglet AcadÃ©mique -->
                    <div class="tab-pane" id="academique" role="tabpanel">
                        <div class="row g-3">
                            <div class="col-12">
                                <h6 class="text-primary fw-semibold mb-3">Informations acadÃ©miques</h6>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Niveau scolaire</label>
                                    <select id="niveau_scolaire" class="form-select form-select-sm border rounded-3 py-2">
                                        <option value="">SÃ©lectionnez un niveau scolaire</option>
                                        <option value="1_am">1 am</option>
                                        <option value="2_am">2 am</option>
                                        <option value="3_am">3 am</option>
                                        <option value="4_am">4 am</option>
                                        <option value="1_as">1 AS</option>
                                        <option value="2_as">2 AS</option>
                                        <option value="terminal">Terminal</option>
                                        <option value="bac1">BAC +1</option>
                                        <option value="bac2">BAC +2</option>
                                        <option value="licence">Licence</option>
                                        <option value="m">Master</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">DiplÃ´me</label>
                                    <input type="text" id="diplome" class="form-control form-control-sm border rounded-3 py-2" placeholder="DiplÃ´me obtenu">
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">Ã‰tablissement d'obtention du diplÃ´me</label>
                                    <input type="text" id="etablissement_diplome" class="form-control form-control-sm border rounded-3 py-2" placeholder="Ã‰tablissement">
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="mb-3">
                                    <label class="form-label fw-medium text-muted">AnnÃ©e d'obtention</label>
                                    <input type="text" id="annee_diplome" class="form-control form-control-sm border rounded-3 py-2" placeholder="AnnÃ©e d'obtention du diplÃ´me">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Pied de page -->
            <div class="modal-footer bg-light-subtle border-top-0 px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2 rounded-3" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" class="btn btn-secondary px-4 py-2 rounded-3" id="prevTabBtn">
                    <i class="ri-arrow-left-line me-2"></i>PrÃ©cÃ©dent
                </button>
                <button type="button" class="btn btn-primary px-4 py-2 rounded-3" id="nextTabBtn">
                    <i class="ri-arrow-right-line me-2"></i>Suivant
                </button>
                <button type="button" class="btn btn-success px-4 py-2 rounded-3" id="saveAdditionalInfoBtn">
                    <i class="ri-checkbox-circle-line me-2"></i>Valider les informations
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Confirmation Informations supplÃ©mentaires -->
<div class="modal fade" id="confirmAdditionalInfoModal" tabindex="-1" aria-labelledby="confirmAdditionalInfoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content border-0 shadow-lg rounded-4">
            <div class="modal-header bg-gradient-primary text-white rounded-top-4 rounded-bottom-0 p-4">
                <div class="d-flex align-items-center">
                    <div class="avatar-lg bg-white bg-opacity-25 rounded-circle me-3">
                        <div class="avatar-title fs-3">
                            <i class="ri-questionnaire-line"></i>
                        </div>
                    </div>
                    <div>
                        <h4 class="modal-title fw-bold mb-1">Confirmer les informations</h4>
                        <p class="mb-0 text-white text-opacity-75">Veuillez vÃ©rifier les informations saisies</p>
                    </div>
                </div>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            
            <div class="modal-body p-4">
                <div class="alert alert-warning d-flex align-items-center rounded-3 mb-4">
                    <div class="flex-shrink-0 me-2">
                        <i class="ri-alert-line fs-4"></i>
                    </div>
                    <div class="flex-grow-1">
                        <p class="mb-0">Veuillez vÃ©rifier attentivement les informations saisies avant de confirmer.</p>
                    </div>
                </div>
                
                <div class="row g-3" id="confirmationDetails">
                    <!-- Les dÃ©tails seront insÃ©rÃ©s ici par JavaScript -->
                </div>
            </div>
            
            <div class="modal-footer bg-light-subtle border-0 rounded-bottom-4 p-4">
                <div class="hstack gap-3 w-100">
                    <button type="button" class="btn btn-light px-4 py-2 rounded-3 flex-grow-1" data-bs-dismiss="modal">
                        <i class="ri-close-line me-2"></i>Modifier
                    </button>
                    <button type="button" class="btn btn-primary px-4 py-2 rounded-3 flex-grow-1" id="confirmSaveAdditionalInfoBtn">
                        <i class="ri-checkbox-circle-line me-2"></i>Confirmer
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal DÃ©tails du Profil -->
<div class="modal fade" id="profileDetailsModal" tabindex="-1" aria-labelledby="profileDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl modal-dialog-scrollable">
        <div class="modal-content border-0 shadow-lg rounded-4">
            <div class="modal-header bg-gradient-info text-white rounded-top-4 rounded-bottom-0 p-3">
                <div class="d-flex align-items-center">
                    <div class="avatar-md bg-white bg-opacity-25 rounded-circle me-2">
                        <div class="avatar-title fs-4">
                            <i class="ri-user-line"></i>
                        </div>
                    </div>
                    <div>
                        <h5 class="modal-title fw-bold mb-0">DÃ©tails du Profil</h5>
                        <p class="mb-0 text-white text-opacity-75 small">Informations complÃ¨tes du prÃ©-inscrit</p>
                    </div>
                </div>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            
            <div class="modal-body p-3">
                <div class="row g-3" id="profileDetailsContent">
                    <!-- Informations d'identitÃ© -->
                    <div class="col-12">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-primary bg-opacity-10 border-0 py-2">
                                <h6 class="card-title text-primary mb-0">
                                    <i class="ri-user-line me-2"></i>Informations d'identitÃ©
                                </h6>
                            </div>
                            <div class="card-body p-3">
                                <div class="row g-2">
                                    <div class="col-md-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Nom en arabe:</div>
                                            <div id="profile_nom_arabe" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">PrÃ©nom en arabe:</div>
                                            <div id="profile_prenom_arabe" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Date de naissance:</div>
                                            <div id="profile_date_naissance">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Lieux naissance</div>
                                            <div id="profile_lieu_naissance">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Nationnalite :</div>
                                            <div id="profile_nationnalite" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">NÂ° identification national (NIN):</div>
                                            <div id="profile_nin" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">NÂ° sÃ©curite social:</div>
                                            <div id="profile_secu" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Informations des parents -->
                    <div class="col-12">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-success bg-opacity-10 border-0 py-2">
                                <h6 class="card-title text-success mb-0">
                                    <i class="ri-group-line me-2"></i>Informations des parents
                                </h6>
                            </div>
                            <div class="card-body p-3">
                                <div class="row g-2">
                                    <div class="col-md-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">PrÃ©nom pÃ¨re:</div>
                                            <div id="profile_prenom_pere" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">TÃ©lÃ©phone pÃ¨re:</div>
                                            <div id="profile_tel_pere">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Nom mÃ¨re:</div>
                                            <div id="profile_nom_mere" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">PrÃ©nom mÃ¨re:</div>
                                            <div id="profile_prenom_mere" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">TÃ©lÃ©phone mÃ¨re:</div>
                                            <div id="profile_tel_mere">-</div>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">TÃ©lÃ©phone mÃ¨re:</div>
                                            <div id="profile_tuteur_legal">-</div>
                                        </div>
                                    </div>

                                    <div class="col-md-4">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">TÃ©lÃ©phone mÃ¨re:</div>
                                            <div id="profile_tel_tuteur">-</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Informations mÃ©dicales -->
                    <div class="col-12">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-warning bg-opacity-10 border-0 py-2">
                                <h6 class="card-title text-warning mb-0">
                                    <i class="ri-heart-line me-2"></i>Informations mÃ©dicales
                                </h6>
                            </div>
                            <div class="card-body p-3">
                                <div class="row g-2">
                                    <div class="col-md-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Personne avec besoin spÃ©cifique:</div>
                                            <div id="profile_has_handicap">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Description du besoin:</div>
                                            <div id="profile_type_handicap" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Groupe sanguin:</div>
                                            <div id="profile_groupe_sanguin">-</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Informations de contact -->
                    <div class="col-12">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-info bg-opacity-10 border-0 py-2">
                                <h6 class="card-title text-info mb-0">
                                    <i class="ri-map-pin-line me-2"></i>Informations de contact
                                </h6>
                            </div>
                            <div class="card-body p-3">
                                <div class="row g-2">
                                    <div class="col-12">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Adresse:</div>
                                            <div id="profile_adresse" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Commune :</div>
                                            <div id="profile_commune" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Pays:</div>
                                            <div id="profile_pays" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Wilaya:</div>
                                            <div id="profile_wilaya" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Code postal:</div>
                                            <div id="profile_code_zip" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Informations acadÃ©miques -->
                    <div class="col-12">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-primary bg-opacity-10 border-0 py-2">
                                <h6 class="card-title text-primary mb-0">
                                    <i class="ri-graduation-cap-line me-2"></i>Informations acadÃ©miques
                                </h6>
                            </div>
                            <div class="card-body p-3">
                                <div class="row g-2">
                                    <div class="col-md-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Niveau scolaire:</div>
                                            <div id="profile_niveau_scolaire" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">DiplÃ´me:</div>
                                            <div id="profile_diplome" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">Ã‰tablissement d'obtention du diplÃ´me:</div>
                                            <div id="profile_etablissement_diplome" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="d-flex">
                                            <div class="text-muted fw-medium me-2">AnnÃ©e d'obtention du diplÃ´me:</div>
                                            <div id="profile_annee_diplome" class="text-truncate">-</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer bg-light-subtle border-0 rounded-bottom-4 p-3">
                <button type="button" class="btn btn-light px-3 py-2 rounded-3" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Fermer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Nouveau Rappel -->
<div class="modal fade" id="addReminderModal" tabindex="-1" aria-labelledby="addReminderModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-success bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-success bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-calendar-check-line text-success fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-success mb-1" id="addReminderModalLabel">
                            Nouveau rappel
                        </h5>
                        <p class="text-muted small mb-0">CrÃ©er un nouveau rappel ou rendez-vous</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="row g-3">
                    <div class="col-12">
                        <label class="form-label fw-medium">Type de rappel</label>
                        <select id="reminderType" class="form-select border-0 bg-light py-2">
                            <option value="appel">Appel</option>
                            <option value="rendez_vous">Rendez-vous</option>
                            <option value="email">Email</option>
                            <option value="autre">Autre</option>
                        </select>
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Objet</label>
                        <input id="reminderSubject" type="text" class="form-control border-0 bg-light py-2" placeholder="Entrez l'objet du rappel">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-medium">Date</label>
                        <input id="reminderDate" type="date" class="form-control border-0 bg-light py-2">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-medium">Heure</label>
                        <input id="reminderTime" type="time" class="form-control border-0 bg-light py-2">
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Description</label>
                        <textarea id="reminderDescription" class="form-control border-0 bg-light" rows="3" placeholder="Entrez une description..."></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" class="btn btn-success px-4 py-2" id="saveReminderBtn">
                    <i class="ri-save-line me-2"></i>Enregistrer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de validation du prÃ©-inscrit -->
<div class="modal fade" id="validatePreinscritModal" tabindex="-1" aria-labelledby="validatePreinscritModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-success bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-success bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-check-double-line text-success fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-success mb-1" id="validatePreinscritModalLabel">
                            Validation de la prÃ©-inscription
                        </h5>
                        <p class="text-muted small mb-0">Confirmation de la validation de la prÃ©-inscription</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="text-center mb-4">
                    <div class="avatar-lg mx-auto mb-3">
                        <div class="avatar-title bg-success bg-opacity-10 text-success display-5 rounded-circle">
                            <i class="ri-user-follow-line"></i>
                        </div>
                    </div>
                    <h5 class="mb-3">ÃŠtes-vous sÃ»r de vouloir valider cette prÃ©-inscription ?</h5>
                    <p class="text-muted mb-0">
                        La validation de la prÃ©-inscription permettra de convertir le prÃ©-inscrit en Ã©tudiant et de commencer le processus d'inscription.
                    </p>
                </div>
                <div class="row g-3">
                    <div class="col-12">
                        <label class="form-label fw-medium">Commentaire de validation (optionnel)</label>
                        <textarea class="form-control border-0 bg-light" rows="3" placeholder="Ajoutez un commentaire..."></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" id="confirmeValidationBtn" class="btn btn-success px-4 py-2">
                    <i class="ri-check-line me-2"></i>Valider la prÃ©-inscription
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de modification du prÃ©-inscrit -->
<div class="modal fade" id="editPreinscritModal" tabindex="-1" aria-labelledby="editPreinscritModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-primary bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-primary bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-edit-line text-primary fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-primary mb-1" id="editPreinscritModalLabel">
                            Modifier les informations
                        </h5>
                        <p class="text-muted small mb-0">Modification des informations du prÃ©-inscrit</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="text-center mb-4">
                    <div class="avatar-lg mx-auto mb-3">
                        <div class="avatar-title bg-primary bg-opacity-10 text-primary display-5 rounded-circle">
                            <i class="ri-user-settings-line"></i>
                        </div>
                    </div>
                    <h4 class="text-primary mb-3">Modification du prÃ©-inscrit</h4>
                    <p class="text-muted mb-4">
                        Veuillez remplir les informations ci-dessous pour mettre Ã  jour les dÃ©tails du prÃ©-inscrit.
                    </p>
                </div>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label fw-medium">Nom</label>
                            <div class="input-group">
                                <span class="input-group-text border-0 bg-light">
                                    <i class="ri-user-line text-muted"></i>
                                </span>
                                <input type="text" id="edit_nom" class="form-control border-0 bg-light py-2" placeholder="Nom">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label fw-medium">PrÃ©nom</label>
                            <div class="input-group">
                                <span class="input-group-text border-0 bg-light">
                                    <i class="ri-user-line text-muted"></i>
                                </span>
                                <input type="text" id="edit_prenom" class="form-control border-0 bg-light py-2" placeholder="PrÃ©nom">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label fw-medium">Email</label>
                            <div class="input-group">
                                <span class="input-group-text border-0 bg-light">
                                    <i class="ri-mail-line text-muted"></i>
                                </span>
                                <input type="email" id="edit_email" class="form-control border-0 bg-light py-2" placeholder="Email">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label fw-medium">TÃ©lÃ©phone</label>
                            <div class="input-group">
                                <span class="input-group-text border-0 bg-light">
                                    <i class="ri-phone-line text-muted"></i>
                                </span>
                                <input type="tel" id="edit_telephone" class="form-control border-0 bg-light py-2" placeholder="TÃ©lÃ©phone">
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="form-group">
                            <label class="form-label fw-medium">Statut</label>
                            <div class="input-group">
                                <span class="input-group-text border-0 bg-light">
                                    <i class="ri-flag-line text-muted"></i>
                                </span>
                                <select id="edit_statut" class="form-select border-0 bg-light py-2">
                                    <option value="en_attente">En attente</option>
                                    <option value="valide">ValidÃ©</option>
                                    <option value="refuse">RefusÃ©</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="form-group">
                            <label class="form-label fw-medium">Note</label>
                            <div class="input-group">
                                <span class="input-group-text border-0 bg-light">
                                    <i class="ri-sticky-note-line text-muted"></i>
                                </span>
                                <textarea id="edit_note" class="form-control border-0 bg-light" rows="3" placeholder="Ajoutez une note..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <div class="hstack gap-2 justify-content-center w-100">
                    <button type="button" class="btn btn-light px-4 py-2 w-100" data-bs-dismiss="modal">
                        <i class="ri-close-line me-2"></i>Annuler
                    </button>
                    <button type="button" id="validateUpdatePreinscritDetailsBtn" class="btn btn-primary px-4 py-2 w-100">
                        <i class="ri-save-line me-2"></i>Enregistrer
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Nouvelle Note -->
<div class="modal fade" id="addNoteModal" tabindex="-1" aria-labelledby="addNoteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-warning bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-warning bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-sticky-note-line text-warning fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-warning mb-1" id="addNoteModalLabel">
                            Nouvelle note
                        </h5>
                        <p class="text-muted small mb-0">Ajouter une nouvelle note ou observation</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="row g-3">
                    <div class="col-12">
                        <textarea id="content_note" class="form-control border-0 bg-light" rows="4" placeholder="Saisissez votre note ici..."></textarea>
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Ã‰tiquettes</label>
                        <select id="note_tags" class="form-select border-0 bg-light py-2">
                            <option value="important">Important</option>
                            <option value="a_revoir">A revoir</option>
                            <option value="a_contacte">A contacter</option>
                            <option value="a_relancer">A relancer</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" class="btn btn-warning px-4 py-2" id="saveNoteBtn">
                    <i class="ri-save-line me-2"></i>Enregistrer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Modification d'une note -->
<div class="modal fade" id="editNoteModal" tabindex="-1" aria-labelledby="editNoteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-warning bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-warning bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-edit-line text-warning fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-warning mb-1" id="editNoteModalLabel">
                            Modifier la note
                        </h5>
                        <p class="text-muted small mb-0">Modification d'une note existante</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="row g-3">
                    <div class="col-12">
                        <label class="form-label fw-medium">Contenu de la note</label>
                        <textarea id="edit_content_note" class="form-control border-0 bg-light" rows="4"></textarea>
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Ã‰tiquettes</label>
                        <select id="edit_note_tags" class="form-select border-0 bg-light py-2">
                            <option value="important">Important</option>
                            <option value="a_revoir">A revoir</option>
                            <option value="a_contacte">A contacter</option>
                            <option value="a_relancer">A relancer</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" class="btn btn-warning px-4 py-2" id="updateNoteBtn">
                    <i class="ri-save-line me-2"></i>Enregistrer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Suppression d'une note -->
<div class="modal fade" id="deleteNoteModal" tabindex="-1" aria-labelledby="deleteNoteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-danger bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-danger bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-delete-bin-line text-danger fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-danger mb-1" id="deleteNoteModalLabel">
                            Supprimer la note
                        </h5>
                        <p class="text-muted small mb-0">Suppression d'une note</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="text-center">
                    <div class="avatar-lg mx-auto mb-4">
                        <div class="avatar-title bg-danger bg-opacity-10 text-danger display-5 rounded-circle">
                            <i class="ri-error-warning-line"></i>
                        </div>
                    </div>
                    <h5 class="mb-3">ÃŠtes-vous sÃ»r de vouloir supprimer cette note ?</h5>
                    <p class="text-muted">
                        La suppression de cette note est dÃ©finitive et ne pourra pas Ãªtre annulÃ©e.
                    </p>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" id='ConfirmDeleteNoteBtn' class="btn btn-danger px-4 py-2">
                    <i class="ri-delete-bin-line me-2"></i>Supprimer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Modification d'un rappel -->
<div class="modal fade" id="editReminderModal" tabindex="-1" aria-labelledby="editReminderModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-primary bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-primary bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-calendar-check-line text-primary fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-primary mb-1" id="editReminderModalLabel">
                            Modifier le rappel
                        </h5>
                        <p class="text-muted small mb-0">Modification des informations du rappel</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="row g-3">
                    <div class="col-12">
                        <label class="form-label fw-medium">Type de rappel</label>
                        <select id="editTypeReminder" class="form-select border-0 bg-light py-2">
                            <option value="appel">Appel</option>
                            <option value="rendez_vous">Rendez-vous</option>
                            <option value="email">Email</option>
                            <option value="autre">Autre</option>
                        </select>
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Objet</label>
                        <input type="text" id="editObjectReminder" class="form-control border-0 bg-light py-2" placeholder="Entrez l'objet du rappel">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-medium">Date</label>
                        <input id="editDateReminder" type="date" class="form-control border-0 bg-light py-2">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-medium">Heure</label>
                        <input id="editTimeReminer" type="time" class="form-control border-0 bg-light py-2">
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Description</label>
                        <textarea id="editDescriptionRemider" class="form-control border-0 bg-light" rows="3" placeholder="Entrez une description..."></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" id="editReminderBtnSave" class="btn btn-primary px-4 py-2">
                    <i class="ri-save-line me-2"></i>Enregistrer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal DÃ©tails d'un rappel -->
<div class="modal fade" id="detailsReminderModal" tabindex="-1" aria-labelledby="detailsReminderModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-info bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-info bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-calendar-check-line text-info fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-info mb-1" id="detailsReminderModalLabel">
                            DÃ©tails du rappel
                        </h5>
                        <p class="text-muted small mb-0">Informations dÃ©taillÃ©es sur le rappel</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="row g-3">
                    <div class="col-12">
                        <div class="d-flex align-items-center mb-3">
                            <div class="icon-circle bg-primary bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="ri-phone-line text-primary"></i>
                            </div>
                            <div>
                                <small class="text-muted d-block mb-1">Type</small>
                                <span class="fw-semibold" id="reminder-type">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center mb-3">
                            <div class="icon-circle bg-info bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="ri-time-line text-info"></i>
                            </div>
                            <div>
                                <small class="text-muted d-block mb-1">Date & Heure</small>
                                <span class="fw-semibold" id="reminder-date-time">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center mb-3">
                            <div class="icon-circle bg-success bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="ri-file-text-line text-success"></i>
                            </div>
                            <div>
                                <small class="text-muted d-block mb-1">Objet</small>
                                <span class="fw-semibold" id="reminder-object">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center mb-3">
                            <div class="icon-circle bg-warning bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="ri-list-check-2 text-warning"></i>
                            </div>
                            <div>
                                <small class="text-muted d-block mb-1">Statut</small>
                                <span class="badge bg-warning-subtle text-warning px-2 py-1" id="reminder-status">
                                    <i class="ri-time-line me-1" ></i>En attente
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex">
                            <div class="icon-circle bg-secondary bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="ri-file-list-line text-secondary"></i>
                            </div>
                            <div>
                                <small class="text-muted d-block mb-1">Description</small>
                                <span class="fw-semibold" id="reminder-description">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Fermer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Suppression d'un rappel -->
<div class="modal fade" id="deleteReminderModal" tabindex="-1" aria-labelledby="deleteReminderModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-danger bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-danger bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-delete-bin-line text-danger fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-danger mb-1" id="deleteReminderModalLabel">
                            Supprimer le rappel
                        </h5>
                        <p class="text-muted small mb-0">Suppression du rappel/rendez-vous</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="text-center">
                    <div class="avatar-lg mx-auto mb-4">
                        <div class="avatar-title bg-danger bg-opacity-10 text-danger display-5 rounded-circle">
                            <i class="ri-error-warning-line"></i>
                        </div>
                    </div>
                    <h5 class="mb-3">ÃŠtes-vous sÃ»r de vouloir supprimer ce rappel ?</h5>
                    <p class="text-muted">
                        La suppression de ce rappel est dÃ©finitive et ne pourra pas Ãªtre annulÃ©e.
                    </p>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" id="ConfirmDeleteReminderBtn" class="btn btn-danger px-4 py-2">
                    <i class="ri-delete-bin-line me-2"></i>Supprimer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Validation Rappel -->
<div class="modal fade" id="validateReminderModal" tabindex="-1" aria-labelledby="validateReminderModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-success bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-success bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-check-line text-success fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-success mb-1" id="validateReminderModalLabel">
                            Valider le rappel
                        </h5>
                        <p class="text-muted small mb-0">Confirmer l'exÃ©cution du rappel</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="row g-3">
                    <div class="col-12">
                        <label class="form-label fw-medium">Statut</label>
                        <select id="validate_statut_reminder" class="form-select border-0 bg-light py-2">
                            <option value="">Selectionnez une option</option>
                            <option value="annule">Annuler</option>
                            <option value="termine">Terminer</option>
                            <option value="abouti">Abouti</option>
                            <option value="nabouti">Non abouti</option>
                        </select>
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Observations</label>
                        <textarea id="observation_rappel" class="form-control border-0 bg-light" rows="4" placeholder="Entrez vos observations..."></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" class="btn btn-success px-4 py-2" id="confirmValidateReminderBtn">
                    <i class="ri-check-line me-2"></i>Valider
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Modification Fiche de Voeux -->
<div class="modal fade" id="editVoeuxModal" tabindex="-1" aria-labelledby="editVoeuxModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-info bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-info bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-graduation-cap-line text-info fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-info mb-1" id="editVoeuxModalLabel">
                            Modifier la fiche de voeux
                        </h5>
                        <p class="text-muted small mb-0">Mise Ã  jour des prÃ©fÃ©rences acadÃ©miques du prÃ©-inscrit</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="row g-3">
                    <div class="col-12">
                        <label class="form-label fw-medium">SpÃ©cialitÃ©</label>
                        <select id="specialite_voeux" class="form-select border-0 bg-light py-2">
                            <option value="">SÃ©lectionnez une spÃ©cialitÃ©</option>
                            <!-- Options Ã  charger dynamiquement -->
                        </select>
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Niveau d'Ã©tude</label>
                        <select id="niveau_etude_voeux" class="form-select border-0 bg-light py-2">
                            <option value="">SÃ©lectionnez un niveau</option>
                            <option value="bac">BaccalaurÃ©at</option>
                            <option value="licence">Licence</option>
                            <option value="master">Master</option>
                            <option value="doctorat">Doctorat</option>
                        </select>
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Ã‰tablissement souhaitÃ©</label>
                        <input type="text" id="etablissement_voeux" class="form-control border-0 bg-light py-2" placeholder="Entrez l'Ã©tablissement souhaitÃ©">
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Commentaires</label>
                        <textarea id="commentaires_voeux" class="form-control border-0 bg-light" rows="4" placeholder="Entrez vos commentaires..."></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" class="btn btn-info px-4 py-2" id="saveVoeuxBtn">
                    <i class="ri-save-line me-2"></i>Enregistrer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Ajout de document -->
<div class="modal fade" id="addDocumentModal" tabindex="-1" aria-labelledby="addDocumentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-warning bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-warning bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-folder-line text-warning fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-warning mb-1" id="addDocumentModalLabel">
                            Ajouter un document
                        </h5>
                        <p class="text-muted small mb-0">Ajouter un nouveau document pour le prÃ©-inscrit</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="alert alert-info d-flex align-items-center rounded-3 mb-4">
                    <div class="flex-shrink-0 me-2">
                        <i class="ri-information-line fs-5"></i>
                    </div>
                    <div class="flex-grow-1">
                        <p class="mb-0">
                            <strong>Restrictions :</strong> Les fichiers ne doivent pas dÃ©passer 400 Ko et seuls les fichiers PDF et JPEG sont autorisÃ©s.
                        </p>
                    </div>
                </div>
                <div class="row g-3">
                    <div class="col-12">
                        <label class="form-label fw-medium">Nom du document</label>
                        <input type="text" id="documentName" class="form-control border-0 bg-light py-2" placeholder="Entrez le nom du document">
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Type de document</label>
                        <select id="documentType" class="form-select border-0 bg-light py-2">
                           
                        </select>
                    </div>
                    <div class="col-12">
                        <label class="form-label fw-medium">Fichier</label>
                        <input type="file" id="documentFile" class="form-control border-0 bg-light py-2">
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" class="btn btn-warning px-4 py-2" id="saveDocumentBtn">
                    <i class="ri-save-line me-2"></i>Enregistrer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Confirmation Suppression Document -->
<div class="modal fade" id="deleteDocumentModal" tabindex="-1" aria-labelledby="deleteDocumentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-danger bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-danger bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-delete-bin-line text-danger fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-danger mb-1" id="deleteDocumentModalLabel">
                            Supprimer le document
                        </h5>
                        <p class="text-muted small mb-0">Confirmation de suppression</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="text-center">
                    <div class="avatar-lg mx-auto mb-4">
                        <div class="avatar-title bg-danger bg-opacity-10 text-danger display-5 rounded-circle">
                            <i class="ri-error-warning-line"></i>
                        </div>
                    </div>
                    <h5 class="mb-3">ÃŠtes-vous sÃ»r de vouloir supprimer ce document ?</h5>
                    <p class="text-muted">
                        Cette action est irrÃ©versible. Le document sera dÃ©finitivement supprimÃ©.
                    </p>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" class="btn btn-danger px-4 py-2" id="confirmDeleteDocumentBtn">
                    <i class="ri-delete-bin-line me-2"></i>Supprimer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Preview Document -->
<div class="modal fade" id="previewDocumentModal" tabindex="-1" aria-labelledby="previewDocumentModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content rounded-4 shadow-lg">
      <div class="modal-header">
        <h5 class="modal-title" id="previewDocumentModalLabel">AperÃ§u du document</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
      </div>
      <div class="modal-body" style="max-height:80vh; overflow-y:auto;">
        <div id="previewContent" class="text-center">
          <!-- Le contenu du document sera injectÃ© ici -->
        </div>

        <!-- Canvas pour pdf.js -->
        <div id="pdfPreviewContainer" style="display:none;">
            <canvas id="pdfCanvas" style="width:100%; border:1px solid #ccc;"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Validation Impossible -->
<div class="modal fade" id="validationBlockedModal" tabindex="-1" aria-labelledby="validationBlockedModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-warning bg-opacity-10 px-3 py-2">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-warning bg-opacity-10 rounded-3 p-2 me-2">
                        <i class="ri-alert-line text-warning fs-5"></i>
                    </div>
                    <div>
                        <h6 class="modal-title fw-bold text-warning mb-0" id="validationBlockedModalLabel">
                            Validation impossible
                        </h6>
                        <p class="text-muted small mb-0 fs-7">Conditions non remplies</p>
                    </div>
                </div>
                <button type="button" class="btn-close fs-6" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-3">
                <div class="text-center mb-3">
                    <div class="avatar-md mx-auto mb-3">
                        <div class="avatar-title bg-warning bg-opacity-10 text-warning display-6 rounded-circle">
                            <i class="ri-indeterminate-circle-line"></i>
                        </div>
                    </div>
                    <h5 class="mb-2 fw-bold">Validation bloquÃ©e</h5>
                    <p class="text-muted mb-0 small">
                        Certaines conditions ne sont pas remplies.
                    </p>
                </div>
                
                <div class="alert alert-warning d-flex align-items-center rounded-3 mb-3 p-2">
                    <div class="flex-shrink-0 me-2">
                        <i class="ri-information-line fs-5"></i>
                    </div>
                    <div class="flex-grow-1">
                        <h6 class="alert-heading fw-bold mb-0 fs-6">Conditions requises</h6>
                        <p class="mb-0 small">
                            Vous devez remplir toutes les conditions ci-dessous :
                        </p>
                    </div>
                </div>
                
                <div class="row g-2">
                    <div class="col-12">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-body p-2">
                                <div class="d-flex align-items-center">
                                    <div class="flex-shrink-0 me-2">
                                        <div class="avatar-xs">
                                            <div class="avatar-title bg-primary bg-opacity-10 text-primary rounded-circle">
                                                <i class="ri-user-line fs-6"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex-grow-1">
                                        <h6 class="mb-0 fw-bold small">Profil complet</h6>
                                        <p class="text-muted mb-0 small">Informations personnelles requises</p>
                                    </div>
                                    <div class="flex-shrink-0">
                                        <i class="ri-close-circle-line text-danger fs-5" id="profileStatusIcon"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-12">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-body p-2">
                                <div class="d-flex align-items-center">
                                    <div class="flex-shrink-0 me-2">
                                        <div class="avatar-xs">
                                            <div class="avatar-title bg-success bg-opacity-10 text-success rounded-circle">
                                                <i class="ri-folder-line fs-6"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex-grow-1">
                                        <h6 class="mb-0 fw-bold small">Documents complets</h6>
                                        <p class="text-muted mb-0 small">Documents requis manquants</p>
                                    </div>
                                    <div class="flex-shrink-0">
                                        <i class="ri-close-circle-line text-danger fs-5" id="documentsStatusIcon"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="alert alert-info d-flex align-items-center rounded-3 mt-3 p-2">
                    <div class="flex-shrink-0 me-2">
                        <i class="ri-lightbulb-line fs-5"></i>
                    </div>
                    <div class="flex-grow-1">
                        <h6 class="alert-heading fw-bold mb-0 fs-6">Conseil</h6>
                        <p class="mb-0 small">
                            Corrigez les problÃ¨mes ou demandez une validation par un responsable.
                        </p>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light-subtle px-3 py-2">
                <button type="button" class="btn btn-light btn-sm px-3 py-1" data-bs-dismiss="modal">
                    <i class="ri-close-line me-1"></i>Fermer
                </button>
                <button type="button" class="btn btn-info btn-icon rounded-circle me-2" id="requestValidationBtn" data-bs-toggle="modal" title="Demander une validation par un responsable" style="width: 36px; height: 36px; padding: 0;">
                    <i class="ri-shield-user-line fs-6"></i>
                </button>
                <button type="button" class="btn btn-warning btn-sm px-3 py-1" id="fixIssuesBtn">
                    <i class="ri-edit-line me-1"></i>Corriger
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Demande de validation par un responsable -->
<div class="modal fade" id="requestManagerValidationModal" tabindex="-1" aria-labelledby="requestManagerValidationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-info bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-info bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-shield-user-line text-info fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-info mb-1" id="requestManagerValidationModalLabel">
                            Demande de validation
                        </h5>
                        <p class="text-muted small mb-0">Demander une validation par un responsable</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="text-center mb-4">
                    <div class="avatar-lg mx-auto mb-3">
                        <div class="avatar-title bg-info bg-opacity-10 text-info display-5 rounded-circle">
                            <i class="ri-shield-user-line"></i>
                        </div>
                    </div>
                    <h5 class="mb-3">Soumettre une demande de validation</h5>
                    <p class="text-muted mb-0">
                        Vous pouvez soumettre une demande de validation pour ce prÃ©-inscrit malgrÃ© les documents incomplets. Un responsable examinera votre demande.
                    </p>
                </div>
                <div class="row g-3">
                    <div class="col-12">
                        <label class="form-label fw-medium">Description</label>
                        <textarea id="validationRequestReason" class="form-control border-0 bg-light" rows="4" placeholder="Expliquez pourquoi vous demandez une validation malgrÃ© les documents incomplets..." ></textarea>   
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Annuler
                </button>
                <button type="button" class="btn btn-info px-4 py-2" id="submitValidationRequestBtn">
                    <i class="ri-send-plane-line me-2"></i>Envoyer la demande
                </button>
            </div>
        </div>  
    </div>
</div>

<!-- Modal Documents Manquants -->
<div class="modal fade" id="missingDocumentsModal" tabindex="-1" aria-labelledby="missingDocumentsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-danger bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-danger bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-file-list-line text-danger fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-bold text-danger mb-1" id="missingDocumentsModalLabel">
                            <i class="ri-alert-line me-2"></i>Documents manquants
                        </h5>
                        <p class="text-muted small mb-0">Liste des documents obligatoires non fournis</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="alert alert-warning d-flex align-items-center rounded-3 mb-4 border-start border-4 border-warning">
                    <div class="flex-shrink-0 me-3">
                        <i class="ri-information-line fs-4 text-warning"></i>
                    </div>
                    <div class="flex-grow-1">
                        <h6 class="alert-heading fw-bold mb-1">Documents requis</h6>
                        <p class="mb-0">
                            Veuillez fournir tous les documents ci-dessous pour complÃ©ter le dossier du prÃ©-inscrit.
                        </p>
                    </div>
                </div>
                
                <div class="table-responsive rounded-3 border">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light">
                            <tr>
                                <th class="border-0 rounded-start">Document requis</th>
                                <th class="border-0 rounded-end text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="missingDocumentsList" class="border-0">
                            <!-- Les documents manquants seront chargÃ©s ici dynamiquement -->
                            <tr>
                                <td colspan="2" class="text-center text-muted py-5">
                                    <div class="spinner-border spinner-border-sm me-2 text-warning" role="status"></div>
                                    <span class="fw-medium">Chargement des documents manquants...</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light-subtle px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2 rounded-3" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Fermer
                </button>
                <button type="button" class="btn btn-warning px-4 py-2 rounded-3" id="refreshMissingDocsBtn">
                    <i class="ri-refresh-line me-2"></i>Actualiser
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal DÃ©tails de la dÃ©rogation -->
<div class="modal fade" id="detailsDerogationModal" tabindex="-1" aria-labelledby="detailsDerogationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-info bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-info bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-file-info-line text-info fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-info mb-1" id="detailsDerogationModalLabel">
                            DÃ©tails de la dÃ©rogation
                        </h5>
                        <p class="text-muted small mb-0">Informations sur la demande de dÃ©rogation</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="row g-3">
                    <div class="col-12">
                        <div class="d-flex align-items-center mb-4">
                            <div class="icon-circle bg-info bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="ri-file-info-line text-info"></i>
                            </div>
                            <div>
                                <small class="text-muted d-block mb-1">Statut de la dÃ©rogation</small>
                                <span class="fw-semibold" id="derogation-status">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center mb-4">
                            <div class="icon-circle bg-info bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="ri-calendar-line text-info"></i>
                            </div>
                            <div>
                                <small class="text-muted d-block mb-1">Date de la demande</small>
                                <span class="fw-semibold" id="derogation-date-demande">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center mb-4">
                            <div class="icon-circle bg-info bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="ri-calendar-line text-info"></i>
                            </div>
                            <div>
                                <small class="text-muted d-block mb-1">Date de traitement</small>
                                <span class="fw-semibold" id="derogation-date-traitement">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex mb-4">
                            <div class="icon-circle bg-info bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="ri-file-text-line text-info"></i>
                            </div>
                            <div>
                                <small class="text-muted d-block mb-1">Motif de la demande</small>
                                <span class="fw-semibold" id="derogation-motif-demande">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex">
                            <div class="icon-circle bg-info bg-opacity-10 rounded-circle p-2 me-3">
                                <i class="ri-file-text-line text-info"></i>
                            </div>
                            <div>
                                <small class="text-muted d-block mb-1">Commentaire du traitement</small>
                                <span class="fw-semibold" id="derogation-commentaire-traitement">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-light px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-close-line me-2"></i>Fermer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de succÃ¨s de finalisation de prÃ©-inscription -->
<div class="modal fade" id="successFinalisationModal" tabindex="-1" aria-labelledby="successFinalisationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow-lg border-0">
            <div class="modal-header border-0 bg-success bg-opacity-10 px-4 py-3">
                <div class="d-flex align-items-center">
                    <div class="modal-icon bg-success bg-opacity-10 rounded-3 p-3 me-3">
                        <i class="ri-check-double-line text-success fs-4"></i>
                    </div>
                    <div>
                        <h5 class="modal-title fw-semibold text-success mb-1" id="successFinalisationModalLabel">
                            PrÃ©-inscription finalisÃ©e avec succÃ¨s
                        </h5>
                        <p class="text-muted small mb-0">Confirmation de la finalisation</p>
                    </div>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <div class="text-center mb-4">
                    <div class="avatar-lg mx-auto mb-3">
                        <div class="avatar-title bg-success bg-opacity-10 text-success display-5 rounded-circle">
                            <i class="ri-check-line"></i>
                        </div>
                    </div>
                    <h5 class="mb-3">PrÃ©-inscription finalisÃ©e avec succÃ¨s !</h5>
                    <p class="text-muted mb-0">
                        La prÃ©-inscription a Ã©tÃ© finalisÃ©e avec succÃ¨s. Une notification de paiement a Ã©tÃ© envoyÃ©e Ã  la trÃ©sorerie.
                    </p>
                </div>
            </div>
            <div class="modal-footer border-0 bg-light px-4 py-3">
                <button type="button" class="btn btn-success px-4 py-2" data-bs-dismiss="modal">
                    <i class="ri-check-line me-2"></i>OK
                </button>
            </div>
        </div>
    </div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>


<script>
    $(document).ready(function(){
        // Activer les tooltips
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        })
        
        let id  = "{{ pk }}";
        var hasHandicap=null;
        let dergorationStatus = false;
        let inscription_validated = false;
        let has_completed_profile = false;


        // Fonction pour charger les notes
        function loadNotes(){
            $.ajax({
                url :"{% url 't_crm:ApiLoadNotePr' %}",
                dataType: "JSON",
                type : 'GET',
                data:{'id_prospect' : id},
                success: function(data){
                    var html = "";

                    if (data.length > 0){
                        $.each(data, function(index, item){
                            html +='<div class="border-start border-4 border-warning ps-4 py-2 bg-white rounded-end">';
                            html +='<div class="d-flex justify-content-between align-items-start mb-2">';
                            html +='<div class="d-flex align-items-center">';
                            html +='<div class="avatar-sm me-3"><div class="avatar-title bg-warning bg-opacity-10 text-warning rounded-circle fs-5">JM</div></div>';
                            html +='<div><h6 class="mb-0 fw-semibold">'+item.created_by__username+'</h6><small class="text-muted">'+item.created_at+'</small></div>';
                            html +='</div>';
                            html +='<div class="dropdown">';
                            html +='<button class="btn btn-icon btn-sm btn-ghost-secondary" data-bs-toggle="dropdown"><i class="ri-more-2-fill"></i></button>';
                            html +='<ul class="dropdown-menu dropdown-menu-end border-0 shadow-sm">';
                            html +='<li><button class="dropdown-item d-flex align-items-center" type="button" data-bs-toggle="modal" data-bs-target="#editNoteModal"><i class="ri-edit-line me-2"></i>Modifier</button></li>';
                            html +='<li><button class="dropdown-item d-flex align-items-center" type="button" data-bs-toggle="modal" data-id="'+item.id+'" id="deleteNoteBtn"><i class="ri-delete-bin-line me-2"></i>Supprimer</button></li>';
                            html +='</ul>';
                            html +='</div>';
                            html +='</div>';
                            html +='<p class="mb-3">'+item.note+'</p>';
                            html +='<div class="d-flex gap-2">';
                            html +='<span class="badge bg-warning-subtle text-warning">'+item.tage+'</span>';
                            html +='</div>';
                            html +='</div>';
                        });
                    }else{
                            html +='<button type="button" class="border-start border-4 border-dashed border-warning ps-4 py-4 bg-white rounded-end text-start w-100" data-bs-toggle="modal" data-bs-target="#addNoteModal">';
                            html +='<div class="d-flex align-items-center">';
                            html +='<div class="avatar-sm me-3">';
                            html +='<div class="avatar-title bg-warning bg-opacity-10 text-warning rounded-circle fs-5">';
                            html +='<i class="ri-add-line"></i>';
                            html +='</div>';
                            html +='</div>';
                            html +='<div>';
                            html +='<h6 class="fw-medium text-warning mb-0">Ajouter une note</h6>';
                            html +='<small class="text-muted">Cliquez pour ajouter une nouvelle note</small>';
                            html +='</div>';
                            html +='</div>';
                            html +='</button>';
                    }

                    $('#ListeDesNotes').html(html);
                }
            });
        }

        // Fonction pour charger la fiche de voeux
        function loadFicheVoeux(){
            $.ajax({
                url : "{% url 't_crm:ApiLoadFicheVoeuxProspect' %}",
                dataType : 'JSON',
                type : 'GET',
                data : {'id_prospect' : id},
                success : function(data){
                    var html="";
                    if (data.fiche_voeux.length > 0){
                        $.each(data.fiche_voeux, function(index, item){
                            html += '<div class="col-12 col-md-4 text-center mb-4 mb-md-0">';
                                    html += '<div class="avatar-lg mx-auto mb-4">';
                                        html += '<div class="avatar-title bg-info bg-opacity-10 text-info display-5 rounded-circle">';
                                            html += '<i class="ri-school-line"></i>';
                                        html += '</div>';
                                    html += '</div>';
                                    html += '<h6 class="fw-semibold mb-2">SpÃ©cialitÃ©</h6>';
                                    html += '<p class="text-muted mb-0">'+item.specialite_label+'</p>';
                                     html += '<h6 class="fw-semibold mb-2 mt-3">Promotion/Session</h6>';
                                    html += '<p class="text-muted mb-0">'+item.promo+'</p>';
                                html += '</div>';
                                html += '<div class="col-12 col-md-8 d-flex align-items-center">';
                                    html += '<div class="vstack gap-4 w-100">';
                                        html += '<div class="d-flex align-items-center justify-content-center">';
                                            html += '<div class="d-flex align-items-center bg-light rounded-3 p-3 w-100">';
                                                html += '<div class="flex-shrink-0">';
                                                    html += '<div class="avatar-sm">';
                                                        html += '<div class="avatar-title bg-info bg-opacity-10 text-info rounded-circle">';
                                                            html += '<i class="ri-calendar-line fs-5"></i>';
                                                        html += '</div>';
                                                    html += '</div>';
                                                html += '</div>';
                                                html += '<div class="flex-grow-1 ms-3 text-center">';
                                                    html += '<h6 class="mb-1">Date de crÃ©ation</h6>';
                                                    html += '<small class="text-muted">'+item.created_at+'</small>';
                                                html += '</div>';
                                            html += '</div>';
                                        html += '</div>';

                                        html += '<div class="d-flex align-items-center justify-content-center">';
                                            html += '<div class="d-flex align-items-center bg-light rounded-3 p-3 w-100">';
                                                html += '<div class="flex-shrink-0">';
                                                    html += '<div class="avatar-sm">';
                                                        html += '<div class="avatar-title bg-info bg-opacity-10 text-info rounded-circle"><i class="ri-time-line fs-5"></i></div>';
                                                    html += '</div>';
                                                html += '</div>';
                                                html += '<div class="flex-grow-1 ms-3 text-center"><h6 class="mb-1">DerniÃ¨re mise Ã  jour</h6><small class="text-muted">'+item.updated_at+'</small></div>';
                                            html += '</div>';
                                        html += '</div>';
                                        
                                    html += '</div>';
                                html += '</div>';

                                $('#editVoeuxBtn').data('id',item.id);
                        });
                    }else{
                        html += '<div class="col-12 text-center py-5">';
                        html += '<div class="avatar-lg mx-auto mb-4">';
                        html += '<div class="avatar-title bg-light text-muted display-5 rounded-circle">';
                        html += '<i class="ri-file-search-line"></i>';
                        html += '</div>';
                        html += '</div>';
                        html += '<h5 class="mb-3">Aucune fiche de vÅ“ux disponible</h5>';
                        html += '<p class="text-muted mb-4">Ce prospect n\'a pas encore de fiche de vÅ“ux enregistrÃ©e.</p>';
                        html += '<button type="button" class="btn btn-soft-primary px-4 py-2" data-bs-toggle="modal" data-bs-target="#voeuxModal">';
                        html += '<i class="ri-add-line me-2"></i>CrÃ©er une fiche de vÅ“ux';
                        html += '</button>';
                        html += '</div>';
                    }

                    $('#preinscritVoeuxDetails').html(html);

                }
            });
        }

        // Fonction pour charger les informations personnelles
        function loadPersonalInfos(){
            
            $.ajax({
                url : "{% url 't_crm:ApiLoadPreinscrisPerosnalInfos' %}",
                dataType : 'JSON',
                type : 'GET',
                data : {'id_prospect' : id},
                success : function(data){
                    $('#nom_prenom').text(data.nom + ' ' + data.prenom);
                    $('#email').text(data.email);
                    $('#phone').text(data.telephone);
                    $('#created_at').text(data.created_at);
                    $('#statut_preinscrit').text(data.statut);

                    if(data.statut_clean === "prinscrit"){
                        $('#date_changement').text(data.preinscri_date);

                    }else if(data.statut_clean === "instance"){
                        $('#date_changement').text(data.instance_date);

                    }else if(data.statut_clean === "convertit"){
                        $('#date_changement').text(data.convertit_date);
                    }else{
                        $('#date_changement').text("Aucune date trouvÃ©e");

                    }

                    $('#profile_nom_arabe').text(data.nom_arabe);
                    $('#profile_prenom_arabe').text(data.prenom_arabe);
                    $('#profile_date_naissance').text(data.date_naissance);
                    $('#profile_lieu_naissance').text(data.lieu_naissance);
                    $('#profile_pays').text(data.pays);
                    $('#profile_wilaya').text(data.wilaya);
                    $('#profile_code_zip').text(data.code_zip);
                    $('#profile_commune').text(data.commune);
                    $('#profile_nin').text(data.nin);
                    $('#profile_nationnalite').text(data.nationnalite);
                    
                    $('#profile_prenom_pere').text(data.prenom_pere);
                    $('#profile_tel_pere').text(data.indic_pere+''+data.tel_pere);
                    $('#profile_nom_mere').text(data.nom_mere);
                    $('#profile_prenom_mere').text(data.prenom_mere);
                    $('#profile_tel_mere').text(data.indic_mere+''+data.tel_mere);
                    $('#profile_tuteur_legal').text(data.tuteur_legal);
                    $('#profile_tel_tuteur').text(data.indic3+''+data.tel_tuteur);

                    if(data.has_endicap == true){
                        var p = "Oui";
                    }else{
                        var p = "Non";
                    }
                    $('#profile_has_handicap').text(p);
                    $('#profile_type_handicap').text(data.type_handicap);
                    $('#profile_groupe_sanguin').text(data.groupe_sanguin);
                    $('#profile_adresse').text(data.adresse);
                    $('#profile_niveau_scolaire').text(data.niveau_scolaire);
                    $('#profile_diplome').text(data.diplome);
                    $('#profile_etablissement_diplome').text(data.etablissement);
                    $('#profile_annee_diplome').text(data.annee_obtention);
                    $('#profile_secu').text(data.secu);
                    
                    $('#nom_arabe').val(data.nom_arabe);
                    $('#prenom_arabe').val(data.prenom_arabe);
                    $('#date_naissance').val(data.date_naissance);
                    $('#nin').val(data.nin);
                    $('#nationnalite').val(data.nationnalite);
                    $('#prenom_pere').val(data.prenom_pere);
                    $('#tel_pere').val(data.tel_pere);
                    $('#indicatif_pere').val(data.indic_pere);
                    $('#indicatif_mere').val(data.indic_mere);
                    $('#nom_mere').val(data.nom_mere);
                    $('#prenom_mere').val(data.prenom_mere);
                    $('#tel_mere').val(data.tel_mere);
                    $('#type_handicap').val(data.type_handicap);
                    if(data.has_endicap == true){
                        var hand = "True";
                    }else{
                        var hand = "False";
                    }
                    $('#has_handicap').val(hand);
                    $('#groupe_sanguin').val(data.groupe_sanguin);
                    $('#adresse_prospect').val(data.adresse);
                    $('#niveau_scolaire').val(data.niveau_scolaire_pure);
                    $('#diplome').val(data.diplome);
                    $('#etablissement_diplome').val(data.etablissement);
                    $('#pays').val(data.pays);
                    $('#wilaya').val(data.wilaya);
                    $('#code_zip').val(data.code_zip);
                    $('#lieu_naissance').val(data.lieu_naissance);
                    $('#commune').val(data.commune);
                    $('#annee_diplome').val(data.annee_obtention);
                    $('#secu').val(data.secu);

                    $('#tuteur_legal').val(data.tuteur_legal);
                    $('#tel_tuteur').val(data.tel_tuteur);
                    $('#indicatif_tuteur').val(data.indic3);

                    if(data.statut_key !== "prinscrit"){
                        document.getElementById("validatePreinscritBtn").disabled = true;
                    };
                }
            });
        }

        // Fonction pour charger les rappels/rendez-vous
        function loadRappelRendezVous(){
            $.ajax({
                url : "{% url 't_crm:ApiLoadPreinscritRendezVous' %}",
                dataType: "JSON",
                type : "GET",
                data : {"id_prospect" : id},
                success : function(data){
                    var row = "";
                    if (data.length > 0){
                        $.each(data, function(index, item){
                            var statutBreak = "";
                            switch(item.statut){
                                case "nabouti":
                                    statutBreak = '<span class="badge bg-primary-subtle text-primary px-2 py-1"><i class="ri-time-line me-1"></i>' + item.status_label + '</span>';
                                break;

                                case "abouti":
                                    statutBreak = '<span class="badge bg-success-subtle text-success px-2 py-1"><i class="ri-time-line me-1"></i>' + item.status_label + '</span>';
                                break;

                                case "termine":
                                    statutBreak = '<span class="badge bg-danger-subtle text-danger px-2 py-1"><i class="ri-time-line me-1"></i>' + item.status_label + '</span>';
                                break;

                                case "nabouti":
                                    statutBreak = '<span class="badge bg-dark-subtle text-dark px-2 py-1"><i class="ri-time-line me-1"></i>' + item.status_label + '</span>';
                                break;

                                case "en_attent":
                                    statutBreak = '<span class="badge bg-warning-subtle text-warning px-2 py-1"><i class="ri-time-line me-1"></i>' + item.status_label + '</span>';
                                break;

                                case "annule":
                                    statutBreak = '<span class="badge bg-danger-subtle text-danger px-2 py-1"><i class="ri-time-line me-1"></i>' + item.status_label + '</span>';
                                break;

                            }
                            row += '<tr>';
                                row += '<td>';
                                    row += '<div class="d-flex align-items-center">';
                                        row += '<div class="icon-circle bg-primary bg-opacity-10 rounded-circle p-2 me-2">';
                                            row += (item.type =="appel") ? '<i class="ri-phone-line text-primary"></i>' : '<i class="ri-calendar-line text-primary"></i>';
                                        row += '</div>';
                                        row += '<span>' + item.type_label + '</span>';
                                    row += '</div>';
                                row += '</td>';
                                row += '<td>';
                                    row += '<div class="text-body">';
                                        row += '<i class="ri-time-line text-muted me-2"></i>' + item.date_rendez_vous +' '+item.heure_rendez_vous+'';

                                    row += '</div>';
                                row += '</td>';
                                row += '<td>';
                                    row += '<div class="text-wrap" style="max-width: 200px;">';
                                        row += '' + item.object + '';
                                    row += '</div>';
                                row += '</td>';
                                row += '<td>';
                                    row += ''+statutBreak+'';
                                row += '</td>';
                                row += '<td class="text-end">';
                                    row += '<div class="d-flex justify-content-end gap-2">';
                                        row += '<button class="btn btn-soft-primary btn-sm" data-bs-toggle="modal" id="editReminderBtn" data-id=' + item.id + '  title="Modifier">';
                                            row += '<i class="ri-edit-line"></i>';
                                        row += '</button>';
                                        row += '<button class="btn btn-soft-info btn-sm" data-bs-toggle="modal" id="detailsReminderBtn" data-id=' + item.id + '  title="DÃ©tails">';
                                            row += '<i class="ri-eye-line"></i>';
                                        row += '</button>';
                                        row += '<button class="btn btn-soft-success btn-sm" data-bs-toggle="modal" id="validateReminderBtn" data-id=' + item.id + '  title="Valider">';
                                            row += '<i class="ri-check-line"></i>';
                                        row += '</button>';
                                        row += '<button class="btn btn-soft-danger btn-sm" data-bs-toggle="modal" id="deleteReminderBtn" data-id=' + item.id + '  title="Supprimer">';
                                            row += '<i class="ri-delete-bin-line"></i>';
                                        row += '</button>';
                                    row += '</div>';
                                row += '</td>';
                            row += '</tr>';
                        });
                    }else{
                        row +="<tr>";
                            row += "<td colspan='5' class='text-center text-muted'>Aucun rappel ou rendez-vous trouvÃ©</td>";
                        row += "</tr>";
                    }

                    $('#listeDesRendezVous').html(row);
                }
            });
        }
        
        // Fonction pour charger les documents
        function loadDocuments(){
            $.ajax({
                url : "{% url 't_crm:LoadPresinscritDocs' %}",
                dataType : "JSON",
                type: 'GET',
                data : {
                    'id_preinscrit' : id,
                },
                success : function(data){
                    var row = "";
                    if(data.length > 0){
                        $.each(data, function(index, item){
                            row += "<tr>";
                                row +="<td>"+item.label+"</td>";
                                row +="<td>"+item.id_document__label+"</td>";
                                row +="<td>"+item.created_at+"</td>";
                                row +="<td class='text-end'>";
                                    row +="<div class='d-flex justify-content-end gap-2'>";
                                        row +="<button data-url='"+item.file+"' class='btn btn-soft-info btn-sm view-doc' title='Voir'>";
                                            row +="<i class='ri-eye-line'></i>";
                                        row +="</button>";
                                        row +="<button class='btn btn-soft-success btn-sm download-doc' data-url='"+item.file+"' title='TÃ©lÃ©charger'>";
                                            row +="<i class='ri-download-line'></i>";
                                        row +="</button>";
                                        row +="<button class='btn btn-soft-danger btn-sm delete-doc' data-id='"+item.id+"' title='Supprimer'>";
                                            row +="<i class='ri-delete-bin-line'></i>";
                                        row +="</button>";
                                    row +="</div>";
                                row +="</td>";

                            row += "</tr>";
                        });
                    }else{
                        var row = "<tr><td colspan='4' class='text-muted text-center'><div class='d-flex flex-column align-items-center justify-content-center py-5'>"+
                                        '<div class="avatar-sm mb-4">'+
                                            '<div class="avatar-title bg-light text-muted rounded-circle fs-1">'+
                                                '<i class="ri-file-paper-2-line"></i>'+
                                            '</div>'+
                                        '</div>'+
                                        '<h5 class="mb-2">Aucun document trouvÃ©</h5>'+
                                        '<p class="text-muted mb-0">Il n\'y a aucun document enregistrÃ© pour le moment</p>'+
                                    '</div></td></tr>';
                    }
                    $('#listeDesDocuments').html(row);
                }
            });
        }

        function CheckCompletedInfos(){
            $.ajax({
                url : "{% url 't_crm:ApiCheckHasCompletedProfile' %}",
                dataType : "JSON",
                type : "GET",
                data : {'id_preinscrit' : id},
                success : function(response){
                    if(response.profile_completed.profile_completed  == "false"){
                        document.getElementById('incompleted_infos').hidden = false;
                        has_completed_profile = false;
                    }else{
                        document.getElementById('incompleted_infos').hidden = true;
                        has_completed_profile = true;
                        
                    }
                }
            });
        }

        CheckCompletedInfos();

        function loadSelectDocuement(){
            $.ajax({
                url : "{% url 't_crm:ApiLoadRequiredDocs' %}",
                dataType : "JSON",
                type : 'GET',
                data : {'id_preinscrit' : id},
                success : function(data){
                    var option ="<option value=''>Veuillez selection un type de document</option>";
                    $.each(data, function(index, item){
                        option += "<option value="+item.id+">"+item.label+"</option>"
                    });
                    $('#documentType').html(option);
                    
                },
            })
        }

        function handleDocs(){
             $.ajax({
                url: "{% url 't_crm:check_all_required_docs' %}",
                dataType: "JSON",
                type: 'GET',
                data: {'id_prospect': id},
                success: function(data) {
                    var html = "";
                    
                    if (data.missing_docs && data.missing_docs.length > 0) {
                        document.getElementById('non_completed_docs').hidden = false;
                        document.getElementById('completed_docs').hidden = true;
                    } else {
                        document.getElementById('non_completed_docs').hidden = true;
                        document.getElementById('completed_docs').hidden = false;
                        
                    }
                    
                },
                error: function() {
                    $('#missingDocumentsList').html(
                        "<tr><td colspan='2' class='text-center text-danger'>Erreur lors du chargement des documents</td></tr>"
                    );
                }
            });
        }

        loadNotes();
        loadFicheVoeux();
        loadPersonalInfos();
        loadRappelRendezVous();
        loadDocuments();
        loadFinancialData(); // Charger les donnÃ©es financiÃ¨res
        
        // Initialiser l'Ã©tat des boutons de navigation
        updateNavigationButtons();

        // Gestionnaires d'Ã©vÃ©nements
        $(document).on('click', '#addNoteModalBtn', function(){
            $('#addNoteModal').modal('show');
        });

        $(document).on('click', '#addReminderBtn', function(){
            $('#addReminderModal').modal('show');
        });

        $(document).on('click', '#saveReminderBtn', function(){
            var type = $('#reminderType').val();
            var subject = $('#reminderSubject').val();
            var date = $('#reminderDate').val();
            var time = $('#reminderTime').val();
            var description = $('#reminderDescription').val();

            $.ajax({
                url: "{% url 't_crm:ApiStoreRappelPreinscrit' %}",
                dataType: 'JSON',
                type: 'POST',
                data: {
                    'type': type,
                    'subject': subject,
                    'date': date,
                    'time': time,
                    'description': description,
                    'id_prospect' : id,
                    'csrfmiddlewaretoken': '{{ csrf_token }}'
                },
                success: function(data) {
                    if (data.status === 'success') {
                        $('#addReminderModal').modal('hide');
                        loadRappelRendezVous();
                        alertify.success(data.message);
                    } else {
                        alertify.error(data.message);
                    }
                }
            });
        });

        $(document).on('click', '#saveNoteBtn', function(){
            var content = $('#content_note').val();
            var tags  = $('#note_tags').val();
            if (content === ""){
                alert("Le contenu de la note ne peut pas Ãªtre vide.");
                return;
            }
            $.ajax({
                url : "{% url 't_crm:ApiStoreNotePreinscrit' %}",
                dataType : 'JSON',
                type : 'POST',
                data : {
                    'id_prospect' : id,
                    'content' : content,
                    'tags' : tags,
                    'csrfmiddlewaretoken' : '{{ csrf_token }}'
                },
                success : function(data){
                    if (data.status === 'success'){
                        $('#addNoteModal').modal('hide');
                        loadNotes();
                        $('#content_note').val('');
                        alertify.success(data.message);
                    }else{
                        alert("Erreur lors de l'enregistrement de la note. Veuillez rÃ©essayer.");
                        alertify.error(data.message);
                    }
                }
            });
        });

        //bouton de validation de la prÃ©inscription
        $(document).on('click', '#validatePreinscritBtn', function(){
            // VÃ©rifier si le profil et les documents sont complets avant de permettre la validation
            let profileCompleted = null;
            let documentsCompleted = null;
            
            if(dergorationStatus == false){
                // VÃ©rifier la complÃ©tude du profil
                $.ajax({
                    url: "{% url 't_crm:ApiCheckHasCompletedProfile' %}",
                    dataType: "JSON",
                    type: "GET",
                    data: {'id_preinscrit': id},
                    success: function(response) {
                        profileCompleted = response.profile_completed.profile_completed  === "true";
                        updateValidationStatus(profileCompleted, documentsCompleted);
                    },
                    error: function() {
                        profileCompleted = false;
                        updateValidationStatus(profileCompleted, documentsCompleted);
                    }
                });
                
                // VÃ©rifier la complÃ©tude des documents
                $.ajax({
                    url: "{% url 't_crm:check_all_required_docs' %}",
                    dataType: "JSON",
                    type: 'GET',
                    data: {'id_prospect': id},
                    success: function(data) {
                        documentsCompleted = !(data.missing_docs && data.missing_docs.length > 0);
                        updateValidationStatus(profileCompleted, documentsCompleted);
                    },
                    error: function() {
                        documentsCompleted = false;
                        updateValidationStatus(profileCompleted, documentsCompleted);
                    }
                });
                
                // Fonction pour mettre Ã  jour l'Ã©tat de validation
                function updateValidationStatus(profileCompleted, documentsCompleted) {
                    // Mettre Ã  jour l'interface de la modale de blocage
                    if (profileCompleted === true) {
                        $('#profileStatusIcon').removeClass('ri-close-circle-line text-danger').addClass('ri-checkbox-circle-line text-success');
                    } else if (profileCompleted === false) {
                        $('#profileStatusIcon').removeClass('ri-checkbox-circle-line text-success').addClass('ri-close-circle-line text-danger');
                    }
                    
                    if (documentsCompleted === true) {
                        $('#documentsStatusIcon').removeClass('ri-close-circle-line text-danger').addClass('ri-checkbox-circle-line text-success');
                    } else if (documentsCompleted === false) {
                        $('#documentsStatusIcon').removeClass('ri-checkbox-circle-line text-success').addClass('ri-close-circle-line text-danger');
                    }
                    
                    // Si les deux vÃ©rifications sont terminÃ©es
                    if (profileCompleted !== null && documentsCompleted !== null) {
                        if (profileCompleted && documentsCompleted) {
                            // Tous les critÃ¨res sont remplis, afficher la modale de validation
                            $('#validatePreinscritModal').modal('show');
                        } else {
                            // Au moins un critÃ¨re n'est pas rempli, afficher la modale de blocage
                            $('#validationBlockedModal').modal('show');
                        }
                    }
                }
            }else {
                 $('#validatePreinscritModal').modal('show');
            }
            


        });

        // Gestionnaire pour le bouton "Corriger les problÃ¨mes"
        $(document).on('click', '#fixIssuesBtn', function(){
            $('#validationBlockedModal').modal('hide');
            
            // VÃ©rifier Ã  nouveau les statuts pour dÃ©terminer oÃ¹ rediriger l'utilisateur
            $.ajax({
                url: "{% url 't_crm:ApiCheckHasCompletedProfile' %}",
                dataType: "JSON",
                type: "GET",
                data: {'id_preinscrit': id},
                success: function(response) {
                    let profileCompleted = response.profile_completed === "true";
                    
                    $.ajax({
                        url: "{% url 't_crm:check_all_required_docs' %}",
                        dataType: "JSON",
                        type: 'GET',
                        data: {'id_prospect': id},
                        success: function(data) {
                            let documentsCompleted = !(data.missing_docs && data.missing_docs.length > 0);
                            
                            // Rediriger selon les problÃ¨mes identifiÃ©s
                            if (!profileCompleted && !documentsCompleted) {
                                // Les deux sont incomplets, demander Ã  l'utilisateur ce qu'il veut corriger en premier
                                alertify.confirm(
                                    "ProblÃ¨mes multiples",
                                    "Le profil et les documents sont incomplets. Voulez-vous d'abord complÃ©ter le profil ?",
                                    function(){
                                        // Oui, complÃ©ter le profil
                                        $('#completeAdditionalInfoBtn').click();
                                    },
                                    function(){
                                        // Non, voir les documents manquants
                                        $('#missingDocumentsModal').modal('show');
                                    }
                                ).set('labels', {ok:'ComplÃ©ter le profil', cancel:'Voir documents manquants'});
                            } else if (!profileCompleted) {
                                // Seulement le profil est incomplet
                                $('#completeAdditionalInfoBtn').click();
                            } else if (!documentsCompleted) {
                                // Seulement les documents sont incomplets
                                $('#missingDocumentsModal').modal('show');
                            }
                        }
                    });
                }
            });
        });

        $(document).on('click', '#confirmeValidationBtn', function(){
            var btn = $(this); // rÃ©fÃ©rence du bouton
            btn.prop('disabled', true); // dÃ©sactive le bouton

            // Optionnel : afficher un spinner pour indiquer le chargement
            var originalText = btn.html();
            btn.html(`
                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                Envoi en cours...
            `);
            $.ajax({
                url : "{% url 't_crm:ApiValidatePreinscrit' %}",
                dataType : "JSON",
                type :"GET",
                data : {
                    'id_preinscrit' : id,
                },
                success : function(response){
                    if(response.status === "success"){
                        $('#validatePreinscritModal').modal('hide');
                        alertify.success("PrÃ©-inscription validÃ©e avec succÃ¨s");
                        $('#successFinalisationModal').modal('show');
                        loadPersonalInfos();
                    }else{
                        $('#validatePreinscritModal').modal('hide');
                        alertify.error(response.message);
                    }
                },
                complete: function() {
                    // RÃ©activer le bouton et restaurer son texte aprÃ¨s la requÃªte
                    btn.prop('disabled', false);
                    btn.html(originalText);
                }
            });              
        });

        $(document).on('click', '#editVoeuxBtn', function(){
            $('#editVoeuxModal').modal('show');
        });

        $(document).on('click', '#saveVoeuxBtn', function(){
            // Simulation d'enregistrement des voeux
            $('#editVoeuxModal').modal('hide');
            alertify.success("Fiche de voeux mise Ã  jour avec succÃ¨s");
        });

        // Gestion des documents
        $(document).on('click', '#addDocumentBtn', function(){
            loadSelectDocuement();
            $('#addDocumentModal').modal('show');
        });

        // Gestion de la suppression des documents
        $(document).on('click', '.delete-doc', function(){
            documentIdToDelete = $(this).data('id');
            $('#deleteDocumentModal').modal('show');
            $('#confirmDeleteDocumentBtn').data('id', documentIdToDelete);
        });

        $(document).on('click', '#confirmDeleteDocumentBtn', function(){
            var confirmDeleteDocumentBtn = $(this).data('id')
            if(documentIdToDelete !== null){
                // Appel AJAX pour supprimer le document
                $.ajax({
                    url: "{% url 't_crm:DeleteDocumentPreinscrit' %}",
                    dataType: "JSON",
                    type: 'POST',
                    data: {
                        'id_document': documentIdToDelete,
                        'csrfmiddlewaretoken': '{{ csrf_token }}'
                    },
                    success: function(response){
                        if(response.status === "success"){
                            alertify.success(response.message);
                            // Recharger la liste des documents
                            loadDocuments();
                            // Fermer la modale
                            $('#deleteDocumentModal').modal('hide');
                            // RÃ©initialiser l'ID du document Ã  supprimer
                            documentIdToDelete = null;

                            handleDocs();
                        } else {
                            alertify.error(response.message);
                        }
                    },
                    error: function(){
                        alertify.error("Erreur lors de la suppression du document");
                    }
                });
            }
        });

        // Gestion du tÃ©lÃ©chargement des documents
        $(document).on('click', '.download-doc', function(){
            var documentUrl = $(this).data('url');
            // CrÃ©er un Ã©lÃ©ment <a> temporaire pour dÃ©clencher le tÃ©lÃ©chargement
            var link = document.createElement('a');
            link.href = documentUrl;
            link.download = ''; // Le nom du fichier sera dÃ©terminÃ© par le serveur
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });

        // Gestion des informations supplÃ©mentaires
        $(document).on('click', '#completeAdditionalInfoBtn', function(){
            $('#additionalInfoModal').modal('show');
        });


        function loadProfileDetails() {
            $.ajax({
                url: "{% url 't_crm:ApiLoadPreinscrisPerosnalInfos' %}",
                dataType: "JSON",
                type: "GET",
                data: {'id_preinscrit': id},
                success: function(data) {
                    // Informations d'identitÃ©
                    $('#profile_nom_arabe').text(data.nom_arabe || '-');
                    $('#profile_prenom_arabe').text(data.prenom_arabe || '-');
                    $('#profile_date_naissance').text(data.date_naissance || '-');
                    $('#profile_nin').text(data.nin || '-');
                    $('#profile_nationnalite').text(data.nationnalite || '-');
                    
                    // Informations des parents
                    $('#profile_prenom_pere').text(data.prenom_pere || '-');
                    $('#profile_tel_pere').text(data.tel_pere || '-');
                    $('#profile_nom_mere').text(data.nom_mere || '-');
                    $('#profile_prenom_mere').text(data.prenom_mere || '-');
                    $('#profile_tel_mere').text(data.tel_mere || '-');
                    $('#indicatif_pere').val(data.indic_pere);

                    // Informations mÃ©dicales
                    var hasHandicap = data.has_handicap === true ? 'Oui' : (data.has_handicap === false ? 'Non' : '-');
                    $('#profile_has_handicap').text(hasHandicap);
                    $('#profile_type_handicap').text(data.type_handicap || '-');
                    $('#profile_groupe_sanguin').text(data.groupe_sanguin || '-');
                    
                    // Informations de contact
                    $('#profile_adresse').text(data.adresse || '-');
                    
                    // Informations acadÃ©miques
                    $('#profile_niveau_scolaire').text(data.niveau_scolaire || '-');
                    $('#profile_diplome').text(data.diplome || '-');
                    $('#profile_etablissement_diplome').text(data.etablissement_diplome || '-');
                },
                error: function() {
                    alertify.error("Erreur lors du chargement des dÃ©tails du profil");
                }
            });
        }

        // Navigation entre les onglets avec les boutons PrÃ©cÃ©dent/Suivant
        function updateNavigationButtons() {
            var activeTab = $('.nav-tabs .nav-link.active');
            var prevTab = activeTab.parent().prev('li').find('.nav-link');
            var nextTab = activeTab.parent().next('li').find('.nav-link');
            
            // Mettre Ã  jour l'Ã©tat des boutons
            if (prevTab.length === 0) {
                $('#prevTabBtn').prop('disabled', true);
            } else {
                $('#prevTabBtn').prop('disabled', false);
            }
            
            if (nextTab.length === 0) {
                $('#nextTabBtn').hide();
                $('#saveAdditionalInfoBtn').show();
            } else {
                $('#nextTabBtn').show();
                $('#saveAdditionalInfoBtn').hide();
            }
        }

        // Lorsque les onglets changent, mettre Ã  jour les boutons
        $('a[data-bs-toggle="tab"]').on('shown.bs.tab', function (e) {
            updateNavigationButtons();
        });

        $(document).on('click', '#nextTabBtn', function(){
            var activeTab = $('.nav-tabs .nav-link.active');
            var nextTab = activeTab.parent().next('li').find('.nav-link');
            
            if (nextTab.length > 0) {
                nextTab.tab('show');
            }
            updateNavigationButtons();
        });

        $(document).on('click', '#prevTabBtn', function(){
            var activeTab = $('.nav-tabs .nav-link.active');
            var prevTab = activeTab.parent().prev('li').find('.nav-link');
            
            if (prevTab.length > 0) {
                prevTab.tab('show');
            }
            updateNavigationButtons();
        });

        // Gestion du clavier (touche EntrÃ©e) pour naviguer entre les onglets
        $('#additionalInfoModal').on('keydown', 'input, select, textarea', function(e) {
            if (e.which === 13) { // Touche EntrÃ©e
                e.preventDefault();
                $('#nextTabBtn').click();
            }
        });

        // Initialiser l'Ã©tat des boutons quand la modale s'ouvre
        $('#additionalInfoModal').on('shown.bs.modal', function () {
            updateNavigationButtons();
        });

        $(document).on('click', '#saveAdditionalInfoBtn', function(){
            // RÃ©cupÃ©ration des valeurs de tous les champs
            var formData = {
                // IdentitÃ©
                'nom_arabe': $('#nom_arabe').val(),
                'prenom_arabe': $('#prenom_arabe').val(),
                'date_naissance': $('#date_naissance').val(),
                'lieu_naissance' : $('#lieu_naissance').val(),
                'secu' : $('#secu').val(),
                'nin': $('#nin').val(),
                'nationnalite' : $('#nationnalite').val(),
                
                // Parents
                'prenom_pere': $('#prenom_pere').val(),
                'tel_pere': $('#tel_pere').val(),
                'indic_pere' : $('#indicatif_pere').val(),
                'nom_mere': $('#nom_mere').val(),
                'prenom_mere': $('#prenom_mere').val(),
                'tel_mere': $('#tel_mere').val(),
                'indic_mere' : $('#indicatif_mere').val(),

                'tuteur_legal' : $('#tuteur_legal').val(),
                'indic3' : $('#indicatif_tuteur').val(),
                'tel_tuteur' : $('#tel_tuteur').val(),

                
                // MÃ©dical
                'has_handicap': $('#has_handicap option:selected').text(),
                'type_handicap': $('#type_handicap').val(),
                'groupe_sanguin': $('#groupe_sanguin').val(),
                
                // Adresse
                'adresse': $('#adresse_prospect').val(),
                'commune' : $('#commune').val(),
                'pays' : $('#pays').val(),
                'wilaya' : $("#wilaya").val(),
                'code_zip' : $('#code_zip').val(),

                // AcadÃ©mique
                'niveau_scolaire': $('#niveau_scolaire').val(),
                'diplome': $('#diplome').val(),
                'etablissement_diplome': $('#etablissement_diplome').val(),
                'annee_diplome' : $('#annee_diplome').val(),
            };
            
            // PrÃ©paration des donnÃ©es pour l'affichage dans la modale de confirmation
            var confirmationHtml = "";
            
            // IdentitÃ©
            confirmationHtml += '<div class="col-12"><h5 class="text-primary fw-bold border-bottom pb-2 mb-3">Informations personnelles</h5></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Nom en arabe</p><h6 class="mb-0">' + (formData.nom_arabe || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">PrÃ©nom en arabe</p><h6 class="mb-0">' + (formData.prenom_arabe || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-3"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Date de naissance</p><h6 class="mb-0">' + (formData.date_naissance || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-3"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Lieu de naissance</p><h6 class="mb-0">' + (formData.lieu_naissance || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">NÂ° identification national (NIN)</p><h6 class="mb-0">' + (formData.nin || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Nationnalite</p><h6 class="mb-0">' + (formData.nationnalite || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">NÂ° SÃ©curite social</p><h6 class="mb-0">' + (formData.secu || '-') + '</h6></div></div>';
            
            // Parents
            confirmationHtml += '<div class="col-12 mt-3"><h5 class="text-success fw-bold border-bottom pb-2 mb-3">Informations des parents</h5></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">PrÃ©nom pÃ¨re</p><h6 class="mb-0">' + (formData.prenom_pere || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">TÃ©lÃ©phone pÃ¨re</p><h6 class="mb-0">' + (formData.indic_pere || '-') + (formData.tel_pere || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-4"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Nom mÃ¨re</p><h6 class="mb-0">' + (formData.nom_mere || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-4"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">PrÃ©nom mÃ¨re</p><h6 class="mb-0">' + (formData.prenom_mere || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-4"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">TÃ©lÃ©phone mÃ¨re</p><h6 class="mb-0">' + (formData.indic_mere || '-') + (formData.tel_mere || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Tuteur lÃ©gal</p><h6 class="mb-0">' + (formData.tuteur_legal || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Telephone</p><h6 class="mb-0">' + (formData.indic3 || '-') + (formData.tel_tuteur || '-') + '</h6></div></div>';
           
            // MÃ©dical
            confirmationHtml += '<div class="col-12 mt-3"><h5 class="text-warning fw-bold border-bottom pb-2 mb-3">Informations mÃ©dicales</h5></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Handicap</p><h6 class="mb-0">' + (formData.has_handicap || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Type handicap</p><h6 class="mb-0">' + (formData.type_handicap || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Groupe sanguin</p><h6 class="mb-0">' + (formData.groupe_sanguin || '-') + '</h6></div></div>';
            
            // Adresse
            confirmationHtml += '<div class="col-12 mt-3"><h5 class="text-info fw-bold border-bottom pb-2 mb-3">Informations de contact</h5></div>';
            confirmationHtml += '<div class="col-12"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Adresse</p><h6 class="mb-0">' + (formData.adresse || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-3"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Commune</p><h6 class="mb-0">' + (formData.commune || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-3"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Wilya</p><h6 class="mb-0">' + (formData.wilaya || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-3"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Pays</p><h6 class="mb-0">' + (formData.pays || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-3"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Code postal</p><h6 class="mb-0">' + (formData.code_zip || '-') + '</h6></div></div>';
            
            // AcadÃ©mique
            confirmationHtml += '<div class="col-12 mt-3"><h5 class="text-primary fw-bold border-bottom pb-2 mb-3">Informations acadÃ©miques</h5></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Niveau scolaire</p><h6 class="mb-0">' + (formData.niveau_scolaire || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-md-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">DiplÃ´me</p><h6 class="mb-0">' + (formData.diplome || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">Ã‰tablissement d\'obtention du diplÃ´me</p><h6 class="mb-0">' + (formData.etablissement_diplome || '-') + '</h6></div></div>';
            confirmationHtml += '<div class="col-6"><div class="bg-light rounded-3 p-3 h-100"><p class="mb-1 text-muted">AnnÃ©e d\'obtention du diplÃ´me</p><h6 class="mb-0">' + (formData.annee_diplome || '-') + '</h6></div></div>';
            
            // Affichage des donnÃ©es dans la modale de confirmation
            $('#confirmationDetails').html(confirmationHtml);
            
            // Affichage de la modale de confirmation
            $('#additionalInfoModal').modal('hide');
            $('#confirmAdditionalInfoModal').modal('show');
        });

        function loadDataToUpdate(tuteur_legal,indicatif_tuteur,tel_tuteur,secu,annee_diplome,commune,wilaya,code_zip,pays,lieu_naissance,nom_arabe,prenom_arabe,date_naissance,nin,nationnalite,prenom_pere,tel_pere,nom_mere,prenom_mere,tel_mere,has_handicap,type_handicap,groupe_sanguin,adresse,niveau_scolaire,diplome,etablissement_diplome,indic_pere,indic_mere){
            $.ajax({
                url : "{% url 't_crm:ApiUpdatePreinscritInfos' %}",
                dataType: "JSON",
                type : "POST",
                data : {
                    'nom_arabe' : nom_arabe,
                    'prenom_arabe' : prenom_arabe,
                    'date_naissance' : date_naissance,
                    'nin' : nin,
                    'nationnalite' : nationnalite,
                    'prenom_pere' : prenom_pere,
                    'tel_pere' : tel_pere,
                    'nom_mere' : nom_mere,
                    'prenom_mere' : prenom_mere,
                    'tel_mere' : tel_mere,
                    'has_handicap' : has_handicap,
                    'type_handicap' : type_handicap,
                    'groupe_sanguin' : groupe_sanguin,
                    'adresse' : adresse,
                    'niveau_scolaire' : niveau_scolaire,
                    'diplome' : diplome,
                    'etablissement_diplome' : etablissement_diplome,
                    'id_preinscrit' : id,
                    'pays' : pays,
                    'wilaya' : wilaya,
                    'code_zip' : code_zip,
                    'lieu_naissance' : lieu_naissance,
                    'indic_pere' : indic_pere,
                    'indic_mere' : indic_mere,
                    'secu' : secu,

                    'commune' : commune,
                    'annee_diplome' : annee_diplome,

                    'tuteur_legal' : tuteur_legal,
                    'indicatif_tuteur' : indicatif_tuteur,
                    'tel_tuteur' : tel_tuteur,

                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },

                success : function(response){
                if (response.status == "success"){
                        alertify.success(response.message);
                        $('#confirmAdditionalInfoModal').modal('hide');
                        loadPersonalInfos();
                        loadFinancialData(); 
                        CheckCompletedInfos();
                }else{
                    alertify.error("Une erreur c'est produite lors du traitement de la requÃªte");
                }
            }
            })
        }
        
        $(document).on('click', '#confirmSaveAdditionalInfoBtn', function(){
            // RÃ©cupÃ©ration des valeurs des champs sous forme de variables individuelles
            var nom_arabe = $('#nom_arabe').val();
            var prenom_arabe = $('#prenom_arabe').val();
            var date_naissance = $('#date_naissance').val();
            var nin = $('#nin').val();
            var nationnalite = $("#nationnalite").val();
            var prenom_pere = $('#prenom_pere').val();
            var tel_pere = $('#tel_pere').val();
            var nom_mere = $('#nom_mere').val();
            var prenom_mere = $('#prenom_mere').val();
            var tel_mere = $('#tel_mere').val();
            var has_handicap = $('#has_handicap').val();
            var type_handicap = $('#type_handicap').val();
            var groupe_sanguin = $('#groupe_sanguin').val();
            var adresse = $('#adresse_prospect').val();
            var niveau_scolaire = $('#niveau_scolaire').val();
            var diplome = $('#diplome').val();
            var etablissement_diplome = $('#etablissement_diplome').val();
            var indic_pere = $('#indicatif_pere').val();
            var indic_mere = $('#indicatif_mere').val();
            var commune = $('#commune').val();
            var annee_diplome = $("#annee_diplome").val();

            var pays = $('#pays').val();
            var wilaya = $('#wilaya').val();
            var code_zip = $('#code_zip').val();
            var lieu_naissance = $('#lieu_naissance').val();
            var secu = $("#secu").val();

            var tuteur_legal = $('#tuteur_legal').val();
            var indicatif_tuteur = $('#indicatif_tuteur').val();
            var tel_tuteur = $('#tel_tuteur').val();
                        
            
            loadDataToUpdate(tuteur_legal,indicatif_tuteur,tel_tuteur,secu,annee_diplome,commune,wilaya,code_zip,pays,lieu_naissance,nom_arabe,prenom_arabe,date_naissance,nin,nationnalite,prenom_pere,tel_pere,nom_mere,prenom_mere,tel_mere,has_handicap,type_handicap,groupe_sanguin,adresse,niveau_scolaire,diplome,etablissement_diplome,indic_pere,indic_mere)
                      
        });
  
        document.getElementById("saveDocumentBtn").addEventListener("click", function () {
            let btn = this; // RÃ©fÃ©rence du bouton
            btn.disabled = true; // DÃ©sactiver le bouton
            let originalText = btn.innerHTML; // Sauvegarder le texte original

            // Afficher un spinner pendant le chargement
            btn.innerHTML = `
                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                Enregistrement...
            `;

            let formData = new FormData();
            formData.append("name", document.getElementById("documentName").value);
            formData.append("type", document.getElementById("documentType").value);
            formData.append("file", document.getElementById("documentFile").files[0]);
            formData.append("csrfmiddlewaretoken", "{{ csrf_token }}");
            formData.append("id_prospect", id); 

            fetch("{% url 't_crm:add_document' %}", {
                method: "POST",
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alertify.success("Le document a Ã©tÃ© ajoutÃ© avec succÃ¨s");
                    $('#addDocumentModal').modal('hide');
                    loadDocuments();
                    handleDocs();
                } else {
                    alertify.error(data.error || "Erreur lors de l'ajout du document");
                }
            })
            .catch(error => {
                console.error("Erreur AJAX:", error);
                alertify.error("Une erreur s'est produite !");
            })
            .finally(() => {
                // RÃ©activer le bouton dans tous les cas
                btn.disabled = false;
                btn.innerHTML = originalText;
            });
        });

        // Gestion de l'affichage dans la modal
        $(document).on("click", ".view-doc", function () {
            var fileUrl = $(this).data("url");
            var previewHtml = "";

            // RÃ©initialiser le container
            $("#previewContent").html("");
            $("#pdfPreviewContainer").hide();

            // DÃ©terminer le type du fichier par extension
            if (fileUrl.match(/\.(jpeg|jpg|png|gif|bmp|webp)$/i)) {
                // Image
                previewHtml = "<img src='" + fileUrl + "' class='img-fluid rounded shadow'>";
                $("#previewContent").html(previewHtml);

            } else if (fileUrl.match(/\.pdf$/i)) {
                // PDF avec pdf.js
                $("#pdfPreviewContainer").show();

                var loadingTask = pdfjsLib.getDocument(fileUrl);
                loadingTask.promise.then(function(pdf) {
                    // Charger la premiÃ¨re page
                    pdf.getPage(1).then(function(page) {
                        var scale = 1.5;
                        var viewport = page.getViewport({scale: scale});

                        var canvas = document.getElementById("pdfCanvas");
                        var context = canvas.getContext("2d");
                        canvas.height = viewport.height;
                        canvas.width = viewport.width;

                        var renderContext = {
                            canvasContext: context,
                            viewport: viewport
                        };
                        page.render(renderContext);
                    });
                }).catch(function(error){
                    $("#previewContent").html(
                        "<p class='text-danger'>Impossible de charger le PDF : " + error + "</p>"
                    );
                    $("#pdfPreviewContainer").hide();
                });

            } else {
                // Autres fichiers (Word, Excel, etc.)
                previewHtml = "<p class='text-muted'>Aucun aperÃ§u disponible pour ce type de fichier.</p>" +
                            "<a href='" + fileUrl + "' class='btn btn-primary' target='_blank'>TÃ©lÃ©charger le fichier</a>";
                $("#previewContent").html(previewHtml);
            }

            // Ouvrir la modal
            $("#previewDocumentModal").modal("show");
        });
     
        handleDocs();

        // Fonction pour charger les documents manquants
        function loadMissingDocuments() {
            $.ajax({
                url: "{% url 't_crm:check_all_required_docs' %}",
                dataType: "JSON",
                type: 'GET',
                data: {'id_prospect': id},
                success: function(data) {
                    var html = "";
                    
                    if (data.missing_docs && data.missing_docs.length > 0) {
                        $.each(data.missing_docs, function(index, doc) {
                            html += "<tr>";
                            html += "<td>" + doc.label + "</td>";
                            html += "<td class='text-center'>";
                            html += "<button class='btn btn-sm btn-primary add-missing-doc' data-doc-id='" + doc.id + "'>";
                            html += "<i class='ri-add-line me-1'></i>Ajouter";
                            html += "</button>";
                            html += "</td>";
                            html += "</tr>";
                        });
                    } else {
                        html += "<tr>";
                        html += "<td colspan='2' class='text-center text-success'>";
                        html += "<i class='ri-checkbox-circle-line fs-4 me-2'></i>";
                        html += "Tous les documents requis ont Ã©tÃ© fournis";
                        html += "</td>";
                        html += "</tr>";
                    }
                    
                    $('#missingDocumentsList').html(html);
                },
                error: function() {
                    $('#missingDocumentsList').html(
                        "<tr><td colspan='2' class='text-center text-danger'>Erreur lors du chargement des documents</td></tr>"
                    );
                }
            });
        }

        // Charger les documents manquants quand la modale s'ouvre
        $('#missingDocumentsModal').on('shown.bs.modal', function () {
            loadMissingDocuments();
        });

        // RafraÃ®chir la liste des documents manquants
        $(document).on('click', '#refreshMissingDocsBtn', function() {
            loadMissingDocuments();
        });

        // GÃ©rer le clic sur le bouton d'ajout de document manquant
        $(document).on('click', '.add-missing-doc', function() {
            var docId = $(this).data('doc-id');
            // Charger les types de documents dans la modale d'ajout
            loadSelectDocuement();
            // SÃ©lectionner automatiquement le document concernÃ©
            $('#documentType').val(docId);
            // Fermer la modale des documents manquants
            $('#missingDocumentsModal').modal('hide');
            // Ouvrir la modale d'ajout de document
            $('#addDocumentModal').modal('show');
        });
        
        function showDerogationDetails(date_de_demande,statut,motif,date_de_traitement,observation){
            $('#derogation-date-demande').html(date_de_demande);
            $('#derogation-motif-demande').html(motif);
            $('#derogation-status').html(statut);
            $('#derogation-date-traitement').html(date_de_traitement);
            $('#derogation-commentaire-traitement').html(observation);
        }

        // Fonction pour vÃ©rifier l'Ã©tat de la dÃ©rogation
        function checkDerogationStatus() {
            $.ajax({
                url: "{% url 't_crm:ApiCheckDerogationStatus' %}",
                dataType: "JSON",
                type: "GET",
                data: {'id_preinscrit': id},
                success: function(response) {

                     showDerogationDetails(
                        response.data.date_de_demande,
                        response.data.statut,
                        response.data.motif,
                        response.data.date_de_traitement,
                        response.data.observation
                    ); 

                    if (response.status === 'acceptee') {
                        document.getElementById('derogation_acceptee').hidden = false;
                        document.getElementById('derogation_refusee').hidden = true;
                        document.getElementById('derogation_attente').hidden = true;
                        document.getElementById('requestValidationBtn').disabled = false;
                        dergorationStatus = true;

                        
                    } else if (response.status === 'rejetee') {
                        document.getElementById('derogation_acceptee').hidden = true;
                        document.getElementById('derogation_refusee').hidden = false;
                        document.getElementById('derogation_attente').hidden = true;
                        document.getElementById('requestValidationBtn').disabled = false;


                    } else if(response.status === "en_attente"){
                        document.getElementById('derogation_attente').hidden = false;
                        document.getElementById('derogation_acceptee').hidden = true;
                        document.getElementById('derogation_refusee').hidden = true;
                        document.getElementById('requestValidationBtn').disabled = true;
                    }else{

                    }
                },
                error: function() {
                    // En cas d'erreur, cacher les deux notifications
                    document.getElementById('derogation_acceptee').hidden = true;
                    document.getElementById('derogation_refusee').hidden = true;
                    document.getElementById('derogation_attente').hidden = true;
                    document.getElementById('requestValidationBtn').disabled = false;

                }
            });
        }

        // Charger l'Ã©tat de la dÃ©rogation au chargement de la page
        checkDerogationStatus();  

        $(document).on('click', '#requestValidationBtn', function(){
            $('#requestManagerValidationModal').modal('show');  
        });

         // GÃ©rer la soumission de la demande de validation par un responsable
        $(document).on('click', '#submitValidationRequestBtn', function() {

            var btn = $(this); // rÃ©fÃ©rence du bouton
            btn.prop('disabled', true); // dÃ©sactive le bouton

            // Optionnel : afficher un spinner pour indiquer le chargement
            var originalText = btn.html();
            btn.html(`
                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                Envoi en cours...
            `);

            var reason = $('#validationRequestReason').val();
            
            $.ajax({
                url : '{% url "t_crm:ApiStoreDerogation" %}',
                dataType: 'JSON',
                type: 'POST',
                data : {
                    'id_preinscrit' : id,
                    'reason' : reason,
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                success : function(response){
                    if (response.status === "success") {
                        alertify.success(response.message);
                        checkDerogationStatus();
                        $('#requestManagerValidationModal').modal('hide');
                        $('#validationRequestReason').val('');

                    }else{
                        alertify.error(response.message);
                    }
                },
                 complete: function() {
                    // RÃ©activer le bouton et restaurer son texte aprÃ¨s la requÃªte
                    btn.prop('disabled', false);
                    btn.html(originalText);
                }
            });      
        });

        // Fonction pour charger les donnÃ©es financiÃ¨res du prÃ©-inscrit
        function loadFinancialData(){
            $.ajax({
                url : "{% url 't_crm:ApiLoadFinancialData' %}",
                dataType: "JSON",
                type: "GET",
                data : {'id_preinscrit' : id},
                success: function(data){
                    // Mise Ã  jour des Ã©lÃ©ments avec les donnÃ©es financiÃ¨res
                    $('#montant-total').text(data.montant_total + ' DZD');
                    $('#montant-paye').text(data.montant_paye + ' DZD');
                    $('#solde').text(parseFloat(data.montant_total - data.montant_paye) + ' DZD');
                    
                    // Mise Ã  jour des couleurs en fonction du solde
                    if (data.solde > 0) {
                        $('#solde').removeClass('text-success text-info').addClass('text-warning');
                    } else if (data.solde < 0) {
                        $('#solde').removeClass('text-success text-warning').addClass('text-info');
                    } else {
                        $('#solde').removeClass('text-info text-warning').addClass('text-success');
                    }
                },
                error: function(){
                    // En cas d'erreur, afficher des valeurs par dÃ©faut
                    $('#montant-total').text('0,00 DZD');
                    $('#montant-paye').text('0,00 DZD');
                    $('#solde').text('0,00 DZD');
                }
            });
        }

        function loadRemiderDetailsForUpdate(id_rendez_vous){
            $.ajax({
                url : "{% url 't_crm:ApiLoadRendezVousDetails' %}",
                dataType: "JSON",
                type: "GET",
                data : {'id_rendez_vous' : id_rendez_vous},
                success: function(data){
                    $('#editDescriptionRemider').val(data[0].description);
                    $('#editDateReminder').val(data[0].date_rendez_vous);
                    $('#editTimeReminer').val(data[0].heure_rendez_vous);
                    $('#editObjectReminder').val(data[0].object);
                    $('#editTypeReminder').val(data[0].type);

                    $('#reminder-type').text(data[0].type_label)
                    $('#reminder-date-time').text(data[0].heure_rendez_vous)
                    $('#reminder-object').text(data[0].object)
                    $('#reminder-status').text(data[0].statut_label)
                    $('#reminder-description').text(data[0].description)


                    
                }
            });
        }

        $(document).on('click', '#editReminderBtn', function(){
            var id_reminder = $(this).data('id');
            loadRemiderDetailsForUpdate(id_reminder);
            $('#editReminderBtnSave').data('id', id_reminder);
            $('#editReminderModal').modal('show');
        });

        $(document).on('click','#editReminderBtnSave', function(){
            var editedDescription = $('#editDescriptionRemider').val();
            var editedType = $('#editTypeReminder').val();
            var editedDate = $('#editDateReminder').val();
            var editedTime = $('#editTimeReminer').val();
            var editedObject = $('#editObjectReminder').val();
            var id_rappel = $(this).data('id');
            $.ajax({
                url : "{% url 't_crm:ApiUpdateRappel' %}",
                dataType : 'JSON',
                type: 'POST',
                data : {
                    'id_rappel' : id_rappel,
                    'type' : editedType,
                    'subject' : editedObject,
                    'date' : editedDate,
                    'time' : editedTime,
                    'description' : editedDescription,
                    'csrfmiddlewaretoken' : '{{ csrf_token }}'
                },

                success : function(response){
                    if(response.status == "success"){
                        alertify.success(response.message);
                        loadRappelRendezVous();
                        $('#editReminderModal').modal('hide');
                        
                    }else{
                        alertify.error(response.message);
                    }
                }
            })
        });

        $(document).on('click', '#detailsReminderBtn', function(){
            var id_reminder = $(this).data('id');
            loadRemiderDetailsForUpdate(id_reminder);
            $('#detailsReminderModal').modal('show');
        });

        $(document).on('click', '#validateReminderBtn', function(){
            var id_reminder = $(this).data('id');
            $('#confirmValidateReminderBtn').data('id', id_reminder);
            $('#validateReminderModal').modal('show');
        });

        $(document).on('click','#confirmValidateReminderBtn', function(){
            var id_reminder = $(this).data('id');
            var description = $('#observation_rappel').val();
            var statut_reminder = $('#validate_statut_reminder').val();

            $.ajax({
                url : "{% url 't_crm:ApiValidateRemider' %}",
                dataType : "JSON",
                type: 'POST',
                data : {
                    'id_reminder' : id_reminder,
                    'description' : description,
                    'statut_reminder' : statut_reminder,
                    'csrfmiddlewaretoken': '{{ csrf_token }}'
                },
                success : function(response){
                    if(response.status === "success"){
                        alertify.success("La validation du rappel a Ã©tÃ© effecuter avec succÃ¨s");
                        loadRappelRendezVous();
                        $('#validateReminderModal').modal('hide');
                    }else{
                        alertify.error("Une erreur c'est produite lors du traitement de la requete !");
                    }
                }
            })
        });

        $(document).on('click', '#deleteReminderBtn', function(){
            var id_reminder = $(this).data('id');
            $('#ConfirmDeleteReminderBtn').data('id', id_reminder);
            $('#deleteReminderModal').modal('show');
        });

        $(document).on('click','#ConfirmDeleteReminderBtn', function(){
            var id_reminder = $(this).data('id');
            $.ajax({
                url :"{% url 't_crm:ApiArchiveReminder' %}",
                dataType : "JSON",
                type: "GET",
                data : {
                    'id_reminder' :  id_reminder,
                },
                success : function(response){
                    if (response.status === "success"){
                        alertify.success("Suppression effectuÃ© avec succÃ¨s");
                        loadRappelRendezVous();
                        $('#deleteReminderModal').modal('hide');
                    }else{  
                        alertify.error("Une erreur c'est produite lors du traitement de la requete !");
                    }
                }
            });
        });

        $(document).on('click', '#viewProfileBtn', function(){
            if (!has_completed_profile){
                $('#profil_incomplet_modal').modal('show');
            }else{
                $('#profileDetailsModal').modal('show');
            }
        });

        $(document).on('click', "#completerProfilBtn",function(){
            $("#profil_incomplet_modal").modal('hide');
            $('#additionalInfoModal').modal('show');
        }); 
       
        document.getElementById('tel_pere').addEventListener('input', function (e) {
            // 1ï¸âƒ£ On rÃ©cupÃ¨re la valeur et on garde uniquement les chiffres
            let value = e.target.value.replace(/\D/g, '');

            // 2ï¸âƒ£ Si le premier caractÃ¨re est un 0, on le supprime
            if (value.startsWith('0')) {
                value = value.slice(1);
            }

            // 3ï¸âƒ£ Reformater selon le schÃ©ma XXX-XX-XX-XX
            let formatted = '';
            if (value.length > 0) formatted += value.substring(0, 3);
            if (value.length >= 4) formatted += '-' + value.substring(3, 5);
            if (value.length >= 6) formatted += '-' + value.substring(5, 7);
            if (value.length >= 8) formatted += '-' + value.substring(7, 9);

            // 4ï¸âƒ£ RÃ©injecter la valeur formatÃ©e dans le champ
            e.target.value = formatted;
        });

        document.getElementById('tel_mere').addEventListener('input', function (e) {
            // 1ï¸âƒ£ On rÃ©cupÃ¨re la valeur et on garde uniquement les chiffres
            let value = e.target.value.replace(/\D/g, '');

            // 2ï¸âƒ£ Si le premier caractÃ¨re est un 0, on le supprime
            if (value.startsWith('0')) {
                value = value.slice(1);
            }

            // 3ï¸âƒ£ Reformater selon le schÃ©ma XXX-XX-XX-XX
            let formatted = '';
            if (value.length > 0) formatted += value.substring(0, 3);
            if (value.length >= 4) formatted += '-' + value.substring(3, 5);
            if (value.length >= 6) formatted += '-' + value.substring(5, 7);
            if (value.length >= 8) formatted += '-' + value.substring(7, 9);

            // 4ï¸âƒ£ RÃ©injecter la valeur formatÃ©e dans le champ
            e.target.value = formatted;
        });

        document.getElementById('tel_tuteur').addEventListener('input', function (e) {
            // 1ï¸âƒ£ On rÃ©cupÃ¨re la valeur et on garde uniquement les chiffres
            let value = e.target.value.replace(/\D/g, '');

            // 2ï¸âƒ£ Si le premier caractÃ¨re est un 0, on le supprime
            if (value.startsWith('0')) {
                value = value.slice(1);
            }

            // 3ï¸âƒ£ Reformater selon le schÃ©ma XXX-XX-XX-XX
            let formatted = '';
            if (value.length > 0) formatted += value.substring(0, 3);
            if (value.length >= 4) formatted += '-' + value.substring(3, 5);
            if (value.length >= 6) formatted += '-' + value.substring(5, 7);
            if (value.length >= 8) formatted += '-' + value.substring(7, 9);

            // 4ï¸âƒ£ RÃ©injecter la valeur formatÃ©e dans le champ
            e.target.value = formatted;
        });
    });
</script>






{% endblock content %}